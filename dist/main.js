!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=12)}([function(e,t,i){e.exports=i(3)(8)},function(e,t,i){e.exports=i(3)(12)},function(e,t,i){e.exports=i(3)(1)},function(e,t){e.exports=dll_library},function(e,t,i){e.exports=i(3)(13)},function(e,t){e.exports='<v-container fluid grid-list-md text-xs-center v-show="show">\n    <v-layout row wrap>\n        <v-flex xs12 style="display: table; width: 100%">\n            <p class="title" style="display: table-cell; vertical-align:middle; width: 100%; height: 2em; min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;">{{queue.join(\' \')}}</p>\n        </v-flex>\n        <v-flex v-for="operation in operations" d-flex xs2>\n            <v-btn :disabled="disabled || queue.length > 9" @click.stop.prevent="twist(operation + suffix)" class="headline" style="width:auto; height:2em; min-width: 0%; min-height: 0%; margin: 0%; text-transform:none">{{operation}}{{suffix}}\n            </v-btn>\n        </v-flex>\n        <v-flex d-flex xs6>\n            <v-btn-toggle v-model="shift" style="width:100%" multiple>\n                <v-btn block class="headline" style="width:auto; height:2em; min-width: 0%; min-height: 0%; margin: 0%; text-transform:none" value="reverse">reverse</v-btn>\n            </v-btn-toggle>\n        </v-flex>\n        <v-flex d-flex xs6>\n            <v-btn-toggle v-model="shift" style="width:100%" multiple>\n                <v-btn block class="headline" style="width:auto; height:2em; min-width: 0%; min-height: 0%; margin: 0%; text-transform:none" value="double">double</v-btn>\n            </v-btn-toggle>\n        </v-flex>\n    </v-layout>\n</v-container>'},function(e,t){e.exports='<v-container fluid grid-list-md text-xs-center v-show="show">\n    <v-layout row wrap>\n        <v-flex xs12 style="margin: 0%; padding: 0%; display: table; width: 100%;">\n            <p class="title" @click="if (!disabled && !playing){dialog = true}" style="\n            word-wrap: break-word; \n            word-break: normal;\n            border: 2px solid rgba(0,0,0,0.54);\n            border-radius: 4px;\n            display: table-cell;\n            vertical-align:middle;\n            width: 100%;\n            height: 2.8em;\n            min-width: 0%;\n            min-height: 0%;\n            margin: 0%;\n            padding: 0%;\n            ">{{exp}}</p>\n        </v-flex>\n        <v-flex xs1 style="margin: 0%; padding: 0%;">\n            <v-spacer></v-spacer>\n        </v-flex>\n        <v-flex xs10 style="margin: 0%; padding: 0%;">\n            <v-slider readonly hide-details thumb-label="false" ticks="always" v-model="progress" :max="actions.length"></v-slider>\n        </v-flex>\n        <v-flex xs1 style="margin: 0%; padding: 0%;">\n            <v-spacer></v-spacer>\n        </v-flex>\n        <v-flex xs1 style="margin: 0%; padding: 0%;">\n            <v-spacer></v-spacer>\n        </v-flex>\n        <v-flex xs2 style="margin: 0%; padding: 0%;">\n            <v-btn icon large :disabled="disabled || playing || progress==0" @click.stop.prevent="start" style="margin: 0%; padding: 0%;">\n                <v-icon>skip_previous</v-icon>\n            </v-btn>\n            </v-btn>\n        </v-flex>\n        <v-flex xs2 style="margin: 0%; padding: 0%;">\n            <v-btn icon large :disabled="disabled || playing || progress==0" @click.stop.prevent="backward" style="margin: 0%; padding: 0%;">\n                <v-icon>fast_rewind</v-icon>\n            </v-btn>\n        </v-flex>\n        <v-flex xs2 style="margin: 0%; padding: 0%;">\n            <v-btn icon large :disabled="(disabled && !playing) || (progress == actions.length)" @click.stop.prevent="playing = !playing; play();" style="margin: 0%; padding: 0%;">\n                <v-icon>{{playing?\'pause\':\'play_arrow\'}}</v-icon>\n            </v-btn>\n        </v-flex>\n        <v-flex xs2 style="margin: 0%; padding: 0%;">\n            <v-btn icon large :disabled="disabled || playing || (progress == actions.length)" @click.stop.prevent="forward" style="margin: 0%; padding: 0%;">\n                <v-icon>fast_forward</v-icon>\n            </v-btn>\n        </v-flex>\n        <v-flex xs2 style="margin: 0%; padding: 0%;">\n            <v-btn icon large :disabled="disabled || playing || progress == actions.length" @click.stop.prevent="end" style="margin: 0%; padding: 0%;">\n                <v-icon>skip_next</v-icon>\n            </v-btn>\n        </v-flex>\n        <v-flex xs1 style="margin: 0%; padding: 0%;">\n            <v-spacer></v-spacer>\n        </v-flex>\n    </v-layout>\n    <v-bottom-sheet v-model="dialog">\n        <v-card tile>\n            <v-container fluid grid-list-md text-xs-center>\n                <v-layout row wrap>\n                    <v-flex xs12>\n                        <v-btn-toggle v-model="type" mandatory style="width:100%">\n                            <template v-for="(group, i) in scripts">\n                                <v-btn style="text-transform:none;" block :disabled="disabled || playing" :value="i">{{type==i?script.name:group.name}}</v-btn>\n                            </template>\n                        </v-btn-toggle>\n                    </v-flex>\n                    <v-flex xs12>\n                        <v-text-field outline single-line hide-details class="title" :append-icon="exp==script.exp?\'\':\'settings_backup_restore\'" @click:append="exp=script.exp" v-model="exp"></v-text-field>\n                    </v-flex>\n                    <v-flex xs3>\n                        <v-btn icon large :disabled="disabled" @click.stop.prevent="index=1" style="margin: 0%; padding: 0%;">\n                            <v-icon>first_page</v-icon>\n                        </v-btn>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs3>\n                        <v-btn icon large :disabled="disabled" @mousedown="indexDown(-1)" @mouseup="indexUp(-1)" @mouseleave="indexUp(-1)" @touchstart.stop.prevent="indexDown(-1)" @touchend.stop.prevent="indexUp(-1)" style="margin: 0%; padding: 0%;">\n                            <v-icon>arrow_back</v-icon>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs3>\n                        <v-btn icon large :disabled="disabled" @mousedown="indexDown(1)" @mouseup="indexUp(1)" @mouseleave="indexUp(1)" @touchstart.stop.prevent="indexDown(1)" @touchend.stop.prevent="indexUp(1)" style="margin: 0%; padding: 0%;">\n                            <v-icon>arrow_forward</v-icon>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs3>\n                        <v-btn icon large :disabled="disabled" @click.stop.prevent="index=scripts[type].scripts.length" style="margin: 0%; padding: 0%;">\n                            <v-icon>last_page</v-icon>\n                        </v-btn>\n                    </v-flex>\n                </v-layout>\n            </v-container>\n        </v-card>\n    </v-bottom-sheet>\n</v-container>'},function(e,t){e.exports='<v-container fluid grid-list-md text-xs-center v-show="show">\n    <v-layout row wrap>\n        <v-flex xs12 style="margin: 0%; padding: 0%; display: table; width: 100%;">\n            <p class="title" @click="random" style="\n                border: 2px solid rgba(0,0,0,0.54);\n                border-radius: 4px;\n                display: table-cell;\n                vertical-align:middle;\n                width: 100%;\n                height: 2.8em;\n                min-width: 0%;\n                min-height: 0%;\n                margin: 0%;\n                padding: 0%;\n            ">{{exp}}</p>\n        </v-flex>\n        <v-flex xs12 style="margin: 0%; padding: 0%; display: table; width: 100%;">\n            <p class="display-4" :class="color" @mousedown="down(1)" @mouseup="up(1)" @mouseleave="up(1)" @touchstart.stop.prevent="down(1)" @touchend.stop.prevent="up(1)" style="display: table-cell; vertical-align:middle; width: 100%; height: 2em; min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;">{{time}}</p>\n        </v-flex>\n    </v-layout>\n</v-container>'},function(e,t){e.exports='<v-app>\n    <div v-resize="resize">\n        <div ref=cuber></div>\n        <div ref=panel>\n            <keyboard-panel :show="mode == \'keyboard\'"></keyboard-panel>\n            <script-panel :disabled="lock" :show="mode == \'script\'"></script-panel>\n            <timer-panel :disabled="lock" :show="mode == \'timer\'"></timer-panel>\n        </div>\n        <v-btn :disabled="lock" fixed top right icon large outline @click.stop.prevent="onMenuClick">\n            <v-icon>menu</v-icon>\n        </v-btn>\n        <v-btn fixed top left icon outline class="title" @click.stop.prevent v-if="exp != \'\'" style="text-transform:none">{{exp}}</v-btn>\n    </div>\n    <v-bottom-sheet v-model="menu">\n        <v-card flat>\n            <v-container fluid grid-list-md text-xs-center>\n                <v-layout row wrap justify-center align-center>\n                    <v-flex xs12>\n                        <p style="margin: 0%; padding: 0%; text-align: left">Mode:</p>\n                    </v-flex>\n                    <v-flex xs12>\n                        <v-btn-toggle v-model="mode" mandatory style="width:100%">\n                            <v-btn flat block value="touch">\n                                <v-icon>touch_app</v-icon>\n                            </v-btn>\n                            <v-btn flat block value="keyboard">\n                                <v-icon>keyboard</v-icon>\n                            </v-btn>\n                            <v-btn flat block value="script">\n                                <v-icon>videocam</v-icon>\n                            </v-btn>\n                            <v-btn flat block value="timer">\n                                <v-icon>timer</v-icon>\n                            </v-btn>\n                        </v-btn-toggle>\n                    </v-flex>\n                    <v-flex xs12>\n                        <p style="margin: 0%; padding: 0%; text-align: left;">Action:</p>\n                    </v-flex>\n                    <v-flex xs4>\n                        <v-btn flat outline block @click.stop.prevent="game.reset()" style="min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;" :disabled="lock || !(mode==\'touch\' || mode==\'keyboard\')">\n                            <v-icon>autorenew</v-icon>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs4>\n                        <v-btn flat outline block @click.stop.prevent="game.random()" style="min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;" :disabled="lock || !(mode==\'touch\' || mode==\'keyboard\')">\n                            <v-icon>casino</v-icon>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs4>\n                        <v-btn flat outline block @click.stop.prevent="reset()" style="min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;" color="error" :disabled="lock">\n                            <v-icon>delete</v-icon>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs12>\n                        <p style="margin: 0%; padding: 0%; text-align: left">Frames:</p>\n                    </v-flex>\n                    <v-flex xs4>\n                        <v-btn icon :disabled="game.duration == 1" @click.stop.prevent="game.duration--" style="min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;">\n                            <v-icon>remove</v-icon>\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs4>\n                        <v-btn block outline @click.stop.prevent :ripple="false" style="min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;">{{game.duration}}\n                        </v-btn>\n                    </v-flex>\n                    <v-flex xs4>\n                        <v-btn icon @click.stop.prevent="game.duration++" style="min-width: 0%; min-height: 0%; margin: 0%; padding: 0%;">\n                            <v-icon>add</v-icon>\n                        </v-btn>\n                    </v-flex>\n                </v-layout>\n            </v-container>\n        </v-card>\n    </v-bottom-sheet>\n</v-app>'},function(e,t,i){e.exports=i(3)(14)},function(e,t,i){e.exports=i(3)(16)},function(e,t,i){e.exports=i(3)(43)},function(e,t,i){"use strict";i.r(t);var n=i(2),s=i(1),a=function(e,t,i,n){var s,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,i,r):s(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},r=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let o=class extends n.default{constructor(){super(...arguments),this.queue=[],this.shift=[],this.operations=["L","D","B","R","U","F","l","d","b","r","u","f","M","E","S","x","y","z"]}get suffix(){let e="";return e=(e=e.concat(-1==this.shift.indexOf("reverse")?"":"'")).concat(-1==this.shift.indexOf("double")?"":"2")}twist(e){this.queue.push(e),this.app.game.twister.twist(e,!1,1,this.callback,!1)}callback(){this.queue.shift()}};a([Object(s.Inject)("app"),r("design:type",P)],o.prototype,"app",void 0),a([Object(s.Prop)({default:!1}),r("design:type",Boolean)],o.prototype,"show",void 0),a([Object(s.Prop)({default:!1}),r("design:type",Boolean)],o.prototype,"disabled",void 0);var l=o=a([Object(s.Component)({template:i(5)})],o),h=i(0);class p extends h.Group{constructor(e,t,i){super(),this._cubelets=[],this.name=e,this._indices=t,this.axis=i,this.matrixAutoUpdate=!1,this.updateMatrix()}set angle(e){this.setRotationFromAxisAngle(this.axis,e),this._angle=e,this.updateMatrix()}get angle(){return this._angle}get exp(){let e=this._angle>0,t=Math.round(Math.abs(this._angle)/(Math.PI/2)),i=new d;return i.exp=this.name,i.times=t,i.reverse=e,i.format()}hold(e){this._angle=0,this._indices.forEach(t=>{let i=e.cube.cubelets[t];this._cubelets.push(i),e.cube.remove(i),this.add(i)},this),e.lock=!0}revert(e){let t=-this._angle;if(0===t){for(;;){let t=this._cubelets.pop();if(void 0===t)break;this.remove(t),e.cube.add(t),e.cube.cubelets[t.index]=t}this._angle=0,e.lock=!1,e.dirty=!0}else{var i=e.duration*Math.min(.5,Math.abs(t)/Math.PI);e.tweener.tween(this.angle,this.angle+t,i,t=>{this.angle=t,e.dirty=!0},()=>{this.revert(e)})}}adjust(e){let t=Math.round(this._angle/(Math.PI/2))*(Math.PI/2)-this._angle;if(0===t){for(;;){let t=this._cubelets.pop();if(void 0===t)break;this.rotate(t),this.remove(t),e.cube.add(t),e.cube.cubelets[t.index]=t}e.lock=!1,e.dirty=!0,this._angle=0}else{var i=e.duration*Math.min(.5,Math.abs(t)/Math.PI);e.tweener.tween(this.angle,this.angle+t,i,t=>{this.angle=t,e.dirty=!0},()=>{this.adjust(e)})}}rotate(e){e.rotateOnWorldAxis(this.axis,this._angle),e.vector=e.vector.applyAxisAngle(this.axis,this._angle),e.updateMatrix()}}p.GROUPS={L:new p("L",[0,3,6,9,12,15,18,21,24],new h.Vector3(-1,0,0)),D:new p("D",[0,1,2,9,10,11,18,19,20],new h.Vector3(0,-1,0)),B:new p("B",[0,1,2,3,4,5,6,7,8],new h.Vector3(0,0,-1)),R:new p("R",[2,5,8,11,14,17,20,23,26],new h.Vector3(1,0,0)),U:new p("U",[6,7,8,15,16,17,24,25,26],new h.Vector3(0,1,0)),F:new p("F",[18,19,20,21,22,23,24,25,26],new h.Vector3(0,0,1)),l:new p("l",[0,3,6,9,12,15,18,21,24,1,4,7,10,13,16,19,22,25],new h.Vector3(-1,0,0)),d:new p("d",[0,1,2,9,10,11,18,19,20,3,4,5,12,13,14,21,22,23],new h.Vector3(0,-1,0)),b:new p("b",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],new h.Vector3(0,0,-1)),r:new p("r",[2,5,8,11,14,17,20,23,26,1,4,7,10,13,16,19,22,25],new h.Vector3(1,0,0)),u:new p("u",[6,7,8,15,16,17,24,25,26,3,4,5,12,13,14,21,22,23],new h.Vector3(0,1,0)),f:new p("f",[18,19,20,21,22,23,24,25,26,9,10,11,12,13,14,15,16,17],new h.Vector3(0,0,1)),M:new p("M",[1,4,7,10,13,16,19,22,25],new h.Vector3(-1,0,0)),E:new p("E",[3,4,5,12,13,14,21,22,23],new h.Vector3(0,-1,0)),S:new p("S",[9,10,11,12,13,14,15,16,17],new h.Vector3(0,0,1)),x:new p("x",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],new h.Vector3(1,0,0)),y:new p("y",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],new h.Vector3(0,1,0)),z:new p("z",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],new h.Vector3(0,0,1))};class c{constructor(e){this._queue=[],this._game=e}get length(){return this._queue.length}twist(e,t=!1,i=1,n=null,s=!1){let a=new m(e,t,i).parse();s?(a.forEach(function(e){let t=-Math.PI/2;e.reverse&&(t=-t),e.times&&(t*=e.times);let i=p.GROUPS[e.exp];void 0!==i&&(i.hold(this._game),i.angle=t,i.adjust(this._game))},this),n&&n()):(a[a.length-1].callback=n,a.forEach(function(e){this._queue.push(e)},this),this.update())}update(){if(0===this._queue.length||this._game.lock)return!1;let e=this._queue.shift();return void 0!=e&&(this.start(e),!0)}start(e){let t=-Math.PI/2;e.reverse&&(t=-t),e.times&&(t*=e.times);let i=this._game.duration*Math.min(.5,Math.abs(t)/Math.PI),n=p.GROUPS[e.exp];if(void 0!==n){n.hold(this._game);for(let t of this._game.callbacks)t(e.format());this._game.tweener.tween(n.angle,n.angle+t,i,e=>{n.angle=e,this._game.dirty=!0},()=>{n.adjust(this._game),e.callback&&e.callback(),this.update(),this._game.dirty=!0})}}match(e){let t,i=[];var n=e.index;if(-1===e.index)return 0===(t=p.GROUPS.x).axis.dot(e.plane.normal)&&i.push(t),0===(t=p.GROUPS.y).axis.dot(e.plane.normal)&&i.push(t),0===(t=p.GROUPS.z).axis.dot(e.plane.normal)&&i.push(t),i;var s=n%3-1,a=Math.floor(n%9/3)-1,r=Math.floor(n/9)-1;switch(s){case-1:0===(t=p.GROUPS.L).axis.dot(e.plane.normal)&&i.push(t);break;case 0:0===(t=p.GROUPS.M).axis.dot(e.plane.normal)&&i.push(t);break;case 1:0===(t=p.GROUPS.R).axis.dot(e.plane.normal)&&i.push(t)}switch(a){case-1:0===(t=p.GROUPS.D).axis.dot(e.plane.normal)&&i.push(t);break;case 0:0===(t=p.GROUPS.E).axis.dot(e.plane.normal)&&i.push(t);break;case 1:0===(t=p.GROUPS.U).axis.dot(e.plane.normal)&&i.push(t)}switch(r){case-1:0===(t=p.GROUPS.B).axis.dot(e.plane.normal)&&i.push(t);break;case 0:0===(t=p.GROUPS.S).axis.dot(e.plane.normal)&&i.push(t);break;case 1:0===(t=p.GROUPS.F).axis.dot(e.plane.normal)&&i.push(t)}return i}}class d{constructor(){this.exp="",this.reverse=!1,this.times=1,this.callback=null}format(){return 0==this.times?"":(this.exp.length>1?"(":"")+this.exp+(this.exp.length>1?")":"")+(this.reverse?"'":"")+(1==this.times?"":String(this.times))}}class m{constructor(e,t=!1,i=1){this._children=[],this._twist=new d;let n=e.replace(/[^xyzbsfdeulmr\(\)'0123456789]/gi,"").match(/\([xyzbsfdeulmr'\d]+\)('\d*|\d*'|\d*)|[xyzbsfdeulmr]('\d*|\d*'|\d*)/gi);if(null!==n)if(1==n.length){var s=n[0].match(/^\((\S+)\)('?)(\d*)('?)$/i);if(null===s){if(null===(s=n[0].match(/([xyzbsfdeulmr])('?)(\d*)('?)/i)))return;this._twist.exp=s[1],/[XYZ]/.test(this._twist.exp)&&(this._twist.exp=this._twist.exp.toLowerCase()),/[mes]/.test(this._twist.exp)&&(this._twist.exp=this._twist.exp.toUpperCase())}else this._children.push(new m(s[1]));this._twist.reverse=0!=(s[2]+s[4]).length,this._twist.times=0==s[3].length?1:parseInt(s[3]),this._twist.reverse=this._twist.reverse!==t,this._twist.times=this._twist.times*i}else this._twist.exp=e,this._twist.reverse=t,this._twist.times=i,n.forEach(function(e){var t=new m(e);this._children.push(t)},this)}parse(e=!1){e=this._twist.reverse!==e;let t=[];if(0!==this._children.length)for(var i=0;i<this._twist.times;i++)for(var n=0;n<this._children.length;n++){(e?this._children[this._children.length-n-1]:this._children[n]).parse(e).forEach(function(e){t.push(e)},this)}else{let i=new d;i.exp=this._twist.exp,i.reverse=e,i.times=this._twist.times,t.push(i)}return t}}var R=function(e,t,i,n){var s,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,i,r):s(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let g=class extends n.default{constructor(){super(...arguments),this.progress=0,this.playing=!1,this.dialog=!1,this.type=Number(window.localStorage.getItem("script.type")||0),this.index=Number(window.localStorage.getItem("script.index")||1),this.scripts=[{name:"F2L",strips:[{indexs:[6,7,8,15,16,17,24,25,26],faces:[0,1,2,3,4,5]}],scripts:[{name:"F2L-01",exp:"URU'R'"},{name:"F2L-02",exp:"x(UR'U'l)"},{name:"F2L-03",exp:"y'(R'U'R)y"},{name:"F2L-04",exp:"(RUR')"},{name:"F2L-05",exp:"y'R2y'(R'U'RU)yR2y"},{name:"F2L-06",exp:"R2y(RUR'U')y'R2"},{name:"F2L-07",exp:"U'(RU'U')(R'U2)(RU'R')"},{name:"F2L-08",exp:"d(R'U2)(RU'U')(R'UR)y"},{name:"F2L-09",exp:"(R2U)y(RU'R'F2)y'"},{name:"F2L-10",exp:"y'(R2U')(F'UF)R2y"},{name:"F2L-11",exp:"y'(RU'U')R'2U'R2U'R'y"},{name:"F2L-12",exp:"(R'U2)(R2'U)(R2'UR)"},{name:"F2L-13",exp:"d(R'URU')(R'U'R)y"},{name:"F2L-14",exp:"U'(RU'R'U)(RUR')"},{name:"F2L-15",exp:"y'(R'U)(Rd'U')(RUR')"},{name:"F2L-16",exp:"(RU'R'U)(dR'U'R)y"},{name:"F2L-17",exp:"(RU'U')(R'U'RU)R'"},{name:"F2L-18",exp:"y'(R'U2)(RUR'U')Ry"},{name:"F2L-19",exp:"U(RU'U')(R'URU')R'"},{name:"F2L-20",exp:"d'zU'(R2U)(R'U'RU)z'y'"},{name:"F2L-21",exp:"Ry(RU2R'F')y'"},{name:"F2L-22",exp:"F'L'U2rUx'"},{name:"F2L-23",exp:"(U2R2'U2)(R'U'RU'R2)"},{name:"F2L-24",exp:"y'(U2R2'U2)(RUR'UR2)y"},{name:"F2L-25",exp:"yU'(L'ULU)y'(RU'R')"},{name:"F2L-26",exp:"(URU'R'U')y'(R'UR)y"},{name:"F2L-27",exp:"(RU'R'U)(RU'R')"},{name:"F2L-28",exp:"y'(R'U)(RU')(R'UR)y"},{name:"F2L-29",exp:"y'(R'U'RU)(R'U'R)y"},{name:"F2L-30",exp:"(RUR'U')(RUR')"},{name:"F2L-31",exp:"(RU'R')y'(R'U2R)y"},{name:"F2L-32",exp:"(RUR'U')2(RUR')"},{name:"F2L-33",exp:"U'(RU')(R'U2)(RU'R')"},{name:"F2L-34",exp:"U'(RU'U'R'U)(RUR')"},{name:"F2L-35",exp:"U'(RUR')d(R'U'R)y"},{name:"F2L-36",exp:"d(R'U'R)d'(RUR')"},{name:"F2L-37",exp:"(RU'2R'U)2y'(R'U'R)y"},{name:"F2L-38",exp:"(RUR'U')(RU'U'R'U')(RUR')"},{name:"F2L-39",exp:"(RU'U')(RUR'U)(RU'U')R2"},{name:"F2L-40",exp:"(RU'RU)y(RU'R'F2)y'"},{name:"F2L-41",exp:"R2y(RUR'U')y'(R'UR')"}]},{name:"OLL",strips:[{indexs:[6,7,8,15,16,17,24,25,26],faces:[0,1,2,4,5]}],scripts:[{name:"OLL-01",exp:"(RU'2)(R2'FRF')U2(R'FRF')"},{name:"OLL-02",exp:"(FRUR'U'F')(fRUR'U'f')"},{name:"OLL-03",exp:"f(RUR'U')f'U'F(RUR'U')F'"},{name:"OLL-04",exp:"f(RUR'U')yx(R'F)(RUR'U')F'y'"},{name:"OLL-05",exp:"(r'U2)(RUR'U)r"},{name:"OLL-06",exp:"(rU'2)(R'U'RU'r')"},{name:"OLL-07",exp:"rUR'URU'2r'"},{name:"OLL-08",exp:"r'U'RU'R'U2r"},{name:"OLL-09",exp:"(R'U'R)y'x'(RU')(R'F)(RUR')xy"},{name:"OLL-10",exp:"(RUR'U)(R'FRF')(RU'2R')"},{name:"OLL-11",exp:"r'(R2UR'U)(RU'2R'U)(rR')"},{name:"OLL-12",exp:"L2lU'z(UR'U')(R2UR')z'rR'"},{name:"OLL-13",exp:"(rU'r'U')(rUr')(F'UF)"},{name:"OLL-14",exp:"R'FRUR'F'R(FU'F')"},{name:"OLL-15",exp:"(r'U'r)(R'U'RU)(r'Ur)"},{name:"OLL-16",exp:"RBR'LUL'U'RB'R'"},{name:"OLL-17",exp:"(RUR'U)(R'FRF'U2)R'FRF'"},{name:"OLL-18",exp:"F(RUR'd)(R'U2)(R'FRF')y"},{name:"OLL-19",exp:"R'U2FRUR'U'y'R2U'2RBy"},{name:"OLL-20",exp:"r'(RU)(RUR'U'r2)(R2'U)(RU')r'"},{name:"OLL-21",exp:"(RU'2)(R'U'RUR'U')(RU'R')"},{name:"OLL-22",exp:"RU'2(R'2U')(R2U')R'2U'2R"},{name:"OLL-23",exp:"(R2D')(RU2)(R'D)(RU2R)"},{name:"OLL-24",exp:"(rUR'U')(r'FRF')"},{name:"OLL-25",exp:"F'(rUR'U')(r'FR)"},{name:"OLL-26",exp:"RU'2R'U'RU'R'"},{name:"OLL-27",exp:"R'U2RUR'UR"},{name:"OLL-28",exp:"(rUR'U')(r'RU)(RU'R')"},{name:"OLL-29",exp:"(R2U'R)F(R'U)(R2U')(R'F'R)"},{name:"OLL-30",exp:"(R2UR'B')(RU')(R2'U)(lUl')"},{name:"OLL-31",exp:"(r'F'UF)(LF'L'U'r)"},{name:"OLL-32",exp:"(RU)(B'U')(R'URBR')"},{name:"OLL-33",exp:"(RUR'U')(R'FRF')"},{name:"OLL-34",exp:"(R'U'RU)x'z'(RU)(L'U')rR'y"},{name:"OLL-35",exp:"RU'2R2'FRF'(RU'2R')"},{name:"OLL-36",exp:"R'U'RU'R'URUlU'R'Ux"},{name:"OLL-37",exp:"F(RU'R'U'RU)(R'F')"},{name:"OLL-38",exp:"(RUR'U)(RU'R'U')(R'FRF')"},{name:"OLL-39",exp:"(LF'L'U'LU)(FU'L')"},{name:"OLL-40",exp:"(R'FRUR'U')(F'UR)"},{name:"OLL-41",exp:"RU'R'U2RUyRU'R'U'F'y'"},{name:"OLL-42",exp:"(R'URU'2R'U')(F'U)(FUR)"},{name:"OLL-43",exp:"(B'U')(R'URB)"},{name:"OLL-44",exp:"f(RUR'U')f'"},{name:"OLL-45",exp:"F(RUR'U')F'"},{name:"OLL-46",exp:"(R'U')R'FRF'(UR)"},{name:"OLL-47",exp:"B'(R'U'RU)2B"},{name:"OLL-48",exp:"F(RUR'U')2F'"},{name:"OLL-49",exp:"RB'(R2F)(R2B)R2F'R"},{name:"OLL-50",exp:"L'B(L2F')(L2B')L2FL'"},{name:"OLL-51",exp:"f(RUR'U')2f'"},{name:"OLL-52",exp:"R'U'RU'R'dR'UlUxy"},{name:"OLL-53",exp:"(r'U2)(RUR'U')(RUR'U)r"},{name:"OLL-54",exp:"(rU'2)(R'U'RUR'U')(RU'r')"},{name:"OLL-55",exp:"(RU'2)(R'2U')RU'R'U2(FRF')"},{name:"OLL-56",exp:"F(RUR'U')(RF')(rUR'U')r'"},{name:"OLL-57",exp:"(RUR'U'r)(R'U)(RU'r')"}]},{name:"PLL",strips:[],scripts:[{name:"PLL-Aa",exp:"x(R2U'2)(R'D')(RU'2)(R'DR')x'"},{name:"PLL-Ab",exp:"x(RD'R)U2R'DRU2R'2x'"},{name:"PLL-E",exp:"x'(RU'R'DRUR')u2'(R'URDR'U'R)x'y2"},{name:"PLL-F",exp:"(R'U'F')(RUR'U')(R'FR2U'R'U')(RUR'UR)"},{name:"PLL-Ga",exp:"(R2uR')(UR'U'Ru')(R'2F'UF)"},{name:"PLL-Gb",exp:"(R'd'F)(R2u)(R'URU'Ru'R'2)y'"},{name:"PLL-Gc",exp:"(R'2u'RU'R)(UR'u)(R2fR'f')"},{name:"PLL-Gd",exp:"(RUR')y'(R2u'RU'R'U)(R'uR2)y"},{name:"PLL-H",exp:"M2UM2U2M2UM2"},{name:"PLL-Ja",exp:"z(U'RD')(R2UR'U')(R2UDR')z'"},{name:"PLL-Jb",exp:"(RUR'F')(RUR'U')(R'F)(R2U'R')"},{name:"PLL-Na",exp:"z(R'UR')z'(RU2L'UR')z(UR')z'(RU2L'UR')"},{name:"PLL-Nb",exp:"z(U'RD')(R2UR'U')z'(RUR')z(R2UR')z'(RU')"},{name:"PLL-Ra",exp:"(RU'2)(R'U2)(RB'R'U')(RURBR2'U)"},{name:"PLL-Rb",exp:"(R'U2)(RU'2)(R'FRUR'U')(R'F'R2U')"},{name:"PLL-T",exp:"(RUR'U')(R'F)(R2U'R'U'RUR'F')"},{name:"PLL-Ua",exp:"(RU'R)(URUR)(U'R'U'R2)"},{name:"PLL-Ub",exp:"(R2U)(RUR'U')(R'U')(R'UR')"},{name:"PLL-V",exp:"(R'UR'U'yx2)(R'UR'U'yx)(U2R'U'RUR)x"},{name:"PLL-Y",exp:"F(RU'R'U')(RUR'F')(RUR'U')(R'FRF')"},{name:"PLL-Z",exp:"(R'U'RU'R)(URU'R'UR)(UR2U'R')U2"}]}],this.timeoutTask=0,this.intervalTask=0,this.exp="",this.actions=new m(this.exp).parse()}onShowChange(e,t){this.stick(),e?(this.onTypeChange(),this.onIndexChange(),this.onScriptChange(),this.onExpChange(this.exp)):this.playing=!1}play(){this.progress==this.actions.length&&(this.playing=!1),this.playing&&this.forward()}forward(){if(this.progress==this.actions.length)return;let e=this.actions[this.progress];this.app.game.twister.twist(e.exp,e.reverse,e.times,this.play,!1),this.progress++}backward(){if(0==this.progress)return;this.progress--;let e=this.actions[this.progress];this.app.game.twister.twist(e.exp,!e.reverse,e.times,this.play,!1)}end(){if(this.progress==this.actions.length)return;let e=this.progress,t=this.actions.length,i=this.actions.slice(e,t);for(let e of i)this.app.game.twister.twist(e.exp,e.reverse,e.times,null,!0);this.progress=this.actions.length}start(){if(0==this.progress)return;let e=this.progress,t=this.actions.slice(0,e).reverse();for(let e of t)this.app.game.twister.twist(e.exp,!e.reverse,e.times,null,!0);this.progress=0}stick(){this.app.game.cube.stick(),this.app.game.dirty=!0}strip(){let e=this.scripts[this.type].strips;for(let t of e)for(let e of t.indexs)this.app.game.cube.strip(e,t.faces);this.app.game.dirty=!0}onIndexChange(){window.localStorage.setItem("script.index",String(this.index))}onTypeChange(e=this.type,t=this.type){window.localStorage.setItem("script.type",String(this.type)),e!=t&&(this.index=1),this.stick(),this.strip()}get script(){let e=this.scripts[this.type].scripts.length,t=this.index;for(;t<1;)t+=e;for(;t>e;)t-=e;let i=this.scripts[this.type].scripts[t-1],n={name:"",exp:""};return n.name=i.name,n.exp=i.exp,n}indexDown(e){return clearTimeout(this.timeoutTask),this.timeoutTask=setTimeout(()=>{this.timeoutTask=0,clearTimeout(this.intervalTask),this.intervalTask=setInterval(()=>{this.index=this.index+e},100)},500),!0}indexUp(e){return 0!=this.timeoutTask&&(clearTimeout(this.timeoutTask),this.index=this.index+e,this.timeoutTask=0),0!=this.intervalTask&&(clearInterval(this.intervalTask),this.intervalTask=0),!0}onExpChange(e){let t=window.localStorage,i=t.getItem(this.script.name);e==this.script.exp?t.removeItem(this.script.name):e!=i&&t.setItem(this.script.name,e),this.actions=new m(this.exp).parse(),this.reset()}onScriptChange(){let e=window.localStorage;this.exp=e.getItem(this.script.name)||this.script.exp}reset(){this.progress=0,this.playing=!1,this.app.game.reset(),this.app.game.twister.twist(this.exp,!0,1,null,!0)}};R([Object(s.Inject)("app"),u("design:type",P)],g.prototype,"app",void 0),R([Object(s.Prop)({default:!1}),u("design:type",Boolean)],g.prototype,"show",void 0),R([Object(s.Watch)("show"),u("design:type",Function),u("design:paramtypes",[Boolean,Boolean]),u("design:returntype",void 0)],g.prototype,"onShowChange",null),R([Object(s.Prop)({default:!1}),u("design:type",Boolean)],g.prototype,"disabled",void 0),R([Object(s.Watch)("index"),u("design:type",Function),u("design:paramtypes",[]),u("design:returntype",void 0)],g.prototype,"onIndexChange",null),R([Object(s.Watch)("type"),u("design:type",Function),u("design:paramtypes",[Number,Number]),u("design:returntype",void 0)],g.prototype,"onTypeChange",null),R([Object(s.Watch)("exp"),u("design:type",Function),u("design:paramtypes",[String]),u("design:returntype",void 0)],g.prototype,"onExpChange",null),R([Object(s.Watch)("script"),u("design:type",Function),u("design:paramtypes",[]),u("design:returntype",void 0)],g.prototype,"onScriptChange",null);var x=g=R([Object(s.Component)({template:i(6)})],g);class v extends h.Geometry{constructor(e,t){super();let i=e/2,n=i-t,s=[[-n,+n,+i],[+n,+n,+i],[+n,-n,+i],[-n,-n,+i],[-n,+i,-n],[+n,+i,-n],[+n,+i,+n],[-n,+i,+n],[-i,-n,-n],[-i,+n,-n],[-i,+n,+n],[-i,-n,+n],[+n,+n,-i],[-n,+n,-i],[-n,-n,-i],[+n,-n,-i],[-n,-i,+n],[+n,-i,+n],[+n,-i,-n],[-n,-i,-n],[+i,+n,+n],[+i,+n,-n],[+i,-n,-n],[+i,-n,+n]];for(let e=0;e<s.length;e++){let t=s[e];this.vertices.push(new h.Vector3(t[0],t[1],t[2]))}for(let e=0;e<v._INDICES.length;e++){let t=v._INDICES[e],i=new h.Face3(t[0],t[1],t[2]);this.faces.push(i)}}}v._INDICES=[[1,6,7],[0,1,7],[3,0,10],[11,3,10],[17,2,3],[16,17,3],[23,20,1],[2,23,1],[5,12,13],[4,5,13],[9,13,14],[8,9,14],[22,15,12],[21,22,12],[19,14,15],[18,19,15],[7,4,9],[10,7,9],[11,8,19],[16,11,19],[23,17,18],[22,23,18],[20,21,5],[6,20,5],[20,6,1],[10,0,7],[21,12,5],[13,9,4],[23,2,17],[11,16,3],[22,18,15],[8,14,19]];class U extends h.Group{constructor(e){super(),this._vector=new h.Vector3,this._stickers=[],this.initial=e;let t=e%3-1,i=Math.floor(e%9/3)-1,n=Math.floor(e/9)-1;this.vector=new h.Vector3(t,i,n),this._materials=[this._vector.x<0?U._MATERIALS.o:U._MATERIALS.i,this._vector.x>0?U._MATERIALS.r:U._MATERIALS.i,this._vector.y<0?U._MATERIALS.w:U._MATERIALS.i,this._vector.y>0?U._MATERIALS.y:U._MATERIALS.i,this._vector.z<0?U._MATERIALS.g:U._MATERIALS.i,this._vector.z>0?U._MATERIALS.b:U._MATERIALS.i];let s=new h.Mesh(U._FRAME,U._MATERIALS.p);this.add(s);for(let e=0;e<6;e++){let t=new h.Mesh(U._EDGE,U._MATERIALS.p),i=new h.Mesh(U._STICKER,this._materials[e]);switch(e){case 0:t.rotation.y=-Math.PI/2,t.position.x=-U._SIZE/2,i.rotation.y=-Math.PI/2,i.position.x=-U._SIZE/2;break;case 1:t.rotation.y=Math.PI/2,t.position.x=U._SIZE/2,i.rotation.y=Math.PI/2,i.position.x=U._SIZE/2;break;case 2:t.rotation.x=Math.PI/2,t.position.y=-U._SIZE/2,i.rotation.x=Math.PI/2,i.position.y=-U._SIZE/2;break;case 3:t.rotation.x=-Math.PI/2,t.position.y=U._SIZE/2,i.rotation.x=-Math.PI/2,i.position.y=U._SIZE/2;break;case 4:t.rotation.x=Math.PI,t.position.z=-U._SIZE/2,i.rotation.x=Math.PI,i.position.z=-U._SIZE/2;break;case 5:t.rotation.z=0,t.position.z=U._SIZE/2,i.rotation.z=0,i.position.z=U._SIZE/2}this.add(t),this.add(i),this._stickers.push(i),this.matrixAutoUpdate=!1,this.updateMatrix()}}set vector(e){this._vector.set(Math.round(e.x),Math.round(e.y),Math.round(e.z)),this._index=9*(this.vector.z+1)+3*(this.vector.y+1)+(this.vector.x+1),this.position.x=U._SIZE*this._vector.x,this.position.y=U._SIZE*this._vector.y,this.position.z=U._SIZE*this._vector.z}get vector(){return this._vector}set index(e){let t=e%3-1,i=Math.floor(e%9/3)-1,n=Math.floor(e/9)-1;this.vector=new h.Vector3(t,i,n)}get index(){return this._index}get identity(){return U.positions.indexOf(this.initial)}get orientation(){return 0}stick(){for(let e=0;e<6;e++)this._stickers[e].material=this._materials[e]}strip(e){this._stickers[e].material=U._MATERIALS.i}}U._SIZE=32,U._BORDER_WIDTH=2,U._EDGE_WIDTH=1,U._FRAME=new v(U._SIZE,U._BORDER_WIDTH),U._EDGE=new class extends h.ShapeGeometry{constructor(e,t){let i=new h.Shape;e/=2,i.moveTo(-e,-e),i.lineTo(-e,e),i.lineTo(e,e),i.lineTo(e,-e),i.closePath();let n=-(e-=t),s=e,a=-e,r=e,o=e/4,l=new h.Shape;l.moveTo(n,a+o),l.quadraticCurveTo(n,a,n+o,a),l.lineTo(r-o,a),l.quadraticCurveTo(r,a,r,a+o),l.lineTo(r,s-o),l.quadraticCurveTo(r,s,r-o,s),l.lineTo(n+o,s),l.quadraticCurveTo(n,s,n,s-o),l.lineTo(n,a+o),l.closePath(),i.holes.push(l),super(i)}}(U._SIZE-2*U._BORDER_WIDTH,U._EDGE_WIDTH),U._STICKER=new class extends h.ShapeGeometry{constructor(e,t){e/=2;let i=-(e-=t),n=e,s=-e,a=e,r=e/4,o=new h.Shape;o.moveTo(i,s+r),o.lineTo(i,n-r),o.quadraticCurveTo(i,n,i+r,n),o.lineTo(a-r,n),o.quadraticCurveTo(a,n,a,n-r),o.lineTo(a,s+r),o.quadraticCurveTo(a,s,a-r,s),o.lineTo(i+r,s),o.quadraticCurveTo(i,s,i,s+r),o.closePath(),super(o)}}(U._SIZE-2*U._BORDER_WIDTH,U._EDGE_WIDTH),U._MATERIALS={p:new h.MeshBasicMaterial({wireframe:!1,color:"#000000"}),i:new h.MeshBasicMaterial({wireframe:!1,color:"#303030"}),g:new h.MeshBasicMaterial({wireframe:!1,color:"#009D54"}),o:new h.MeshBasicMaterial({wireframe:!1,color:"#FF6C00"}),b:new h.MeshBasicMaterial({wireframe:!1,color:"#3D81F6"}),y:new h.MeshBasicMaterial({wireframe:!1,color:"#FDCC09"}),w:new h.MeshBasicMaterial({wireframe:!1,color:"#FFFFFF"}),r:new h.MeshBasicMaterial({wireframe:!1,color:"#DC422F"})},U.positions=[25,17,7,15,19,11,1,9,23,21,5,3,26,8,6,24,20,18,0,2];class f extends h.Group{constructor(e){super(),this.cubelets=[],this._initial=[];for(var t=0;t<27;t++){let e=new U(t);this.cubelets.push(e),this._initial.push(e),this.add(e)}this.matrixAutoUpdate=!1,this.updateMatrix()}compare(e,t){return e.index-t.index}reset(){for(let e of this.cubelets)e.setRotationFromEuler(new h.Euler(0,0,0)),e.index=e.initial,e.updateMatrix();this.cubelets.sort(this.compare)}stick(){for(let e of this.cubelets)e.stick()}strip(e,t){for(let i of t)this._initial[e].strip(i)}get state(){let e=[],t=[];for(let i of U.positions)e.push(this.cubelets[i].identity),t.push(this.cubelets[i].orientation);return e.concat(t)}}class _{constructor(){this._tweens=[],this.loop()}loop(){requestAnimationFrame(this.loop.bind(this)),this.update()}tween(e,t,i,n,s){this._tweens.push(new y(e,t,i,n,s))}update(){if(0===this._tweens.length)return!1;for(var e=0;e<this._tweens.length;)this._tweens[e].update()?e++:this._tweens.splice(e,1);return!0}}class y{constructor(e,t,i,n,s){this._value=0,this._begin=e,this._end=t,this._duration=i,this._update=n,this._finish=s}update(){this._value++;let e=this._value/this._duration;e=e>1?1:e;let t=1- --e*e;return this._update(this._begin+(this._end-this._begin)*t),1!=t||(this._finish(),!1)}}class w{}class b{constructor(e){this._dragging=!1,this._rotating=!1,this._onMouseDown=(e=>{if(this._game.lock)return!0;this._down.x=e.offsetX,this._down.y=e.offsetY,this._handleDown()}),this._onMouseMove=(e=>{this._move.x=e.offsetX,this._move.y=e.offsetY,this._handleMove()}),this._onMouseUp=(e=>{this._handleUp()}),this._onMouseOut=(e=>{this._handleUp()}),this._onTouch=(e=>{let t=e.changedTouches[0];switch(e.type){case"touchstart":if(this._game.lock)return!0;this._down.x=t.clientX,this._down.y=t.clientY,this._handleDown();break;case"touchmove":this._move.x=t.clientX,this._move.y=t.clientY,this._handleMove();break;case"touchend":this._handleUp();break;default:return}}),this._game=e,this._ray=new h.Ray,this._down=new h.Vector2(0,0),this._move=new h.Vector2(0,0),this._matrix=new h.Matrix4,this._holder=new w,this._holder.vector=new h.Vector3,this._vector=new h.Vector3,this._planes=[new h.Plane(new h.Vector3(1,0,0),3*-L.SIZE/64),new h.Plane(new h.Vector3(0,1,0),3*-L.SIZE/64),new h.Plane(new h.Vector3(0,0,1),3*-L.SIZE/64)],this._game.canvas.addEventListener("mousedown",this._onMouseDown),this._game.canvas.addEventListener("mousemove",this._onMouseMove),this._game.canvas.addEventListener("mouseup",this._onMouseUp),this._game.canvas.addEventListener("mouseout",this._onMouseOut),this._game.canvas.addEventListener("touchstart",this._onTouch,!0),this._game.canvas.addEventListener("touchmove",this._onTouch,!0),this._game.canvas.addEventListener("touchend",this._onTouch,!0)}_intersect(e,t){var i=e.x/this._game.canvas.clientWidth*2-1,n=-e.y/this._game.canvas.clientHeight*2+1;this._ray.origin.setFromMatrixPosition(this._game.camera.matrixWorld),this._ray.direction.set(i,n,.5).unproject(this._game.camera).sub(this._ray.origin).normalize(),this._ray.applyMatrix4(this._matrix.identity().getInverse(this._game.scene.matrix));var s=new h.Vector3;return this._ray.intersectPlane(t,s),s}_handleDown(){this._dragging=!0,this._holder.index=-1,this._planes.some(e=>{var t=this._intersect(this._down,e);if(null!==t&&Math.abs(t.x)<=48.01&&Math.abs(t.y)<=48.01&&Math.abs(t.z)<=48.01){this._holder.plane=e;var i=Math.ceil(Math.round(t.x)/32-.5),n=Math.ceil(Math.round(t.y)/32-.5),s=Math.ceil(Math.round(t.z)/32-.5);return this._holder.index=i<2&&i>-2&&n<2&&n>-2&&s<2&&s>-2?9*(s+1)+3*(n+1)+(i+1):-1,!0}return!1},this),this._game.dirty=!0}_handleMove(){if(this._dragging){var e=this._move.x-this._down.x,t=this._move.y-this._down.y,i=Math.sqrt(e*e+t*t);if(Math.min(this._game.canvas.clientWidth,this._game.canvas.clientHeight)/i>100)return!0;if(this._game.lock)return this._dragging=!1,this._rotating=!1,!0;if(this._dragging=!1,this._rotating=!0,-1===this._holder.index)e*e>t*t?this._group=p.GROUPS.y:this._down.x<this._game.canvas.clientWidth/2?this._group=p.GROUPS.x:this._group=p.GROUPS.z;else{var n=this._intersect(this._down,this._holder.plane),s=this._intersect(this._move,this._holder.plane);this._vector.subVectors(s,n);var a=this._vector.x,r=this._vector.y,o=this._vector.z,l=Math.max(Math.abs(a),Math.abs(r),Math.abs(o));a=Math.abs(a)===l?a:0,r=Math.abs(r)===l?r:0,o=Math.abs(o)===l?o:0,this._vector.set(a,r,o),this._holder.vector.copy(this._vector.multiply(this._vector).normalize()),this._game.twister.match(this._holder).some(e=>0===e.axis.dot(this._vector)&&(this._group=e,!0),this),this._vector.crossVectors(this._holder.vector,this._holder.plane.normal),this._holder.vector.multiplyScalar(this._vector.x+this._vector.y+this._vector.z)}this._group.hold(this._game)}if(this._rotating){if(-1===this._holder.index){e=this._move.x-this._down.x,t=this._move.y-this._down.y;this._group===p.GROUPS.y?this._group.angle=e/Math.min(this._game.canvas.clientWidth,this._game.canvas.clientHeight)*Math.PI*2:this._group===p.GROUPS.x?this._group.angle=t/Math.min(this._game.canvas.clientWidth,this._game.canvas.clientHeight)*Math.PI*2:this._group.angle=-t/Math.min(this._game.canvas.clientWidth,this._game.canvas.clientHeight)*Math.PI*2}else{n=this._intersect(this._down,this._holder.plane),s=this._intersect(this._move,this._holder.plane);this._vector.subVectors(s,n).multiply(this._holder.vector),this._group.angle=-(this._vector.x+this._vector.y+this._vector.z)*(this._group.axis.x+this._group.axis.y+this._group.axis.z)/L.SIZE*Math.PI*8}this._game.dirty=!0}}_handleUp(){if(this._rotating&&this._group&&null!==this._group)if(this._game.enable){for(let e of this._game.callbacks)e(this._group.exp);this._group.adjust(this._game)}else this._group.revert(this._game);this._holder.index=-1,this._dragging=!1,this._rotating=!1,this._game.dirty=!0}}class L{constructor(){this.lock=!1,this.enable=!0,this.dirty=!0,this.duration=60,this.callbacks=[],this.scene=new h.Scene,this.scene.rotation.x=Math.PI/8,this.scene.rotation.y=Math.PI/16-Math.PI/4,this.camera=new h.PerspectiveCamera(50,1,1,L.SIZE),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=L.SIZE/3,this.tweener=new _,this.twister=new c(this),this.cube=new f(this),this.scene.add(this.cube);for(let e in p.GROUPS)this.scene.add(p.GROUPS[e]);this.renderer=new h.WebGLRenderer({antialias:!0}),this.renderer.setClearColor(16777215),this.renderer.setPixelRatio(window.devicePixelRatio),this.canvas=this.renderer.domElement,this.controller=new b(this),this.loop()}random(){let e="";if(!this.lock){let t=[],i=-1,n=["U","D","R","L","F","B"],s=-1;for(let e=0;e<20;e++){let e=[];for(;s==i;)s=Math.floor(3*Math.random());let a=Math.floor(2*Math.random());e.push(n[2*s+a]);let r=Math.random();r<.2?e.push("2"):r<.6&&e.push("'"),t.push(e.join("")),i=s}e=t.join(" "),this.twister.twist(e,!1,1,null,!0),this.dirty=!0}return e}reset(){this.lock||(this.cube.reset(),this.dirty=!0)}resize(e,t){this.camera.aspect=e/t;let i=t/Math.min(e,t)*L.SIZE/4,n=2*Math.atan(i/L.SIZE)*180/Math.PI;this.camera.fov=n,this.camera.lookAt(this.scene.position),this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t,!0),this.dirty=!0}render(){this.dirty&&(this.renderer.render(this.scene,this.camera),this.dirty=!1)}loop(){requestAnimationFrame(this.loop.bind(this)),this.render()}}L.SIZE=1024;var F=function(e,t,i,n){var s,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,i,r):s(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},M=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let k=class extends n.default{constructor(){super(...arguments),this.exp=window.localStorage.getItem("timer.exp")||"",this.start=0,this.lapse=Number(window.localStorage.getItem("timer.lapse")||0),this.timeoutTask=0,this.intervalTask=0,this.press=!1}onShowChange(e,t){e&&(""==this.exp?this.random():(this.app.game.reset(),this.app.game.twister.twist(this.exp,!1,1,null,!0)))}onExpChange(e,t){window.localStorage.setItem("timer.exp",this.exp)}get time(){let e=Math.floor(this.lapse/1e3/60),t=Math.floor(this.lapse%6e4/1e3),i=Math.floor(this.lapse%1e3/10);return(0==e?"":String(e)+":")+("0"+String(t)).substr(-2)+":"+("0"+String(i)).substr(-2)}get lock(){return!(!this.press&&0==this.intervalTask&&0==this.timeoutTask)}random(){this.lock||(this.app.game.reset(),this.exp=this.app.game.random())}down(){if(this.press=!0,0!=this.lapse)if(0!=this.start){clearInterval(this.intervalTask),this.intervalTask=0;let e=new Date;this.lapse=e.getTime()-this.start,window.localStorage.setItem("timer.lapse",String(this.lapse)),this.start=0}else clearTimeout(this.timeoutTask),this.timeoutTask=setTimeout(()=>{this.lapse=0,this.timeoutTask=0},1e3)}get color(){if(this.press){if(0!=this.timeoutTask)return"red--text";if(0==this.lapse)return"green--text"}return"black--text"}up(){if(this.press=!1,clearTimeout(this.timeoutTask),this.timeoutTask=0,0==this.lapse){let e=new Date;this.start=e.getTime(),clearInterval(this.intervalTask),this.intervalTask=setInterval(()=>{let e=new Date;this.lapse=e.getTime()-this.start},100)}}};F([Object(s.Inject)("app"),M("design:type",P)],k.prototype,"app",void 0),F([Object(s.Prop)({default:!1}),M("design:type",Boolean)],k.prototype,"show",void 0),F([Object(s.Watch)("show"),M("design:type",Function),M("design:paramtypes",[Boolean,Boolean]),M("design:returntype",void 0)],k.prototype,"onShowChange",null),F([Object(s.Watch)("exp"),M("design:type",Function),M("design:paramtypes",[String,String]),M("design:returntype",void 0)],k.prototype,"onExpChange",null);var O=k=F([Object(s.Component)({template:i(7)})],k),S=function(e,t,i,n){var s,a=arguments.length,r=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(r=(a<3?s(r):a>3?s(t,i,r):s(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r},I=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let T=class extends n.default{constructor(){super(...arguments),this.app=this,this.game=new L,this.exp="",this.expTask=0,this.menu=!1,this.mode="touch"}get duration(){return this.game.duration}onDurationChange(){window.localStorage.setItem("duration",String(this.duration))}resize(){if(this.$refs.cuber instanceof HTMLElement&&this.$refs.panel instanceof HTMLElement){let e=this.$refs.cuber,t=this.$refs.panel.clientHeight,i=window.innerHeight-t;this.game.resize(e.clientWidth,i)}}mounted(){if(this.$refs.cuber instanceof Element){this.$refs.cuber.appendChild(this.game.canvas),this.resize()}let e=window.localStorage;this.game.duration=Number(e.getItem("duration")||this.game.duration),this.mode=window.localStorage.getItem("mode")||"touch",this.game.callbacks.push(this.onTwist)}onTwist(e){this.exp=e,clearTimeout(this.expTask),this.expTask=setTimeout(()=>{this.exp=""},500)}onMenuClick(){this.menu=!this.menu}onModeChange(e,t){window.localStorage.setItem("mode",this.mode),"touch"!=t&&"touch"==e&&(this.game.enable=!0),"touch"==t&&"touch"!=e&&(this.game.enable=!1),this.$nextTick(this.resize)}get lock(){return this.game.lock||0!=this.game.twister.length}reset(){window.localStorage.clear(),window.location.reload()}};S([Object(s.Provide)("app"),I("design:type",T)],T.prototype,"app",void 0),S([Object(s.Watch)("duration"),I("design:type",Function),I("design:paramtypes",[]),I("design:returntype",void 0)],T.prototype,"onDurationChange",null),S([Object(s.Watch)("mode"),I("design:type",Function),I("design:paramtypes",[String,String]),I("design:returntype",void 0)],T.prototype,"onModeChange",null);var P=T=S([Object(s.Component)({template:i(8),components:{"keyboard-panel":l,"script-panel":x,"timer-panel":O}})],T),E=i(4),j=i.n(E);i(9),i(10),i(11);n.default.use(j.a),new n.default({el:"#app",render:e=>e(P)})}]);