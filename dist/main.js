!function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=13)}([function(e,t,i){e.exports=i(3)(14)},function(e,t,i){e.exports=i(3)(27)},function(e,t,i){e.exports=i(3)(2)},function(e,t){e.exports=dll_library},function(e,t,i){e.exports=i(3)(28)},function(e,t){e.exports='<v-container fluid grid-list-md text-xs-center :style="{width:width + \'px\', height:height + \'px\'}" style="padding:0%;touch-action: none;">\n  <v-layout row wrap style="margin: 0%; padding:0%; min-width: 0%; min-height: 0%;">\n    <v-flex xs2 d-flex style="padding:0%; min-width: 0%; min-height: 0%;">\n      <v-btn @click.native.stop.prevent="layers=(layers+1)%3" @touchstart.native.stop.prevent="layers=(layers+1)%3" depressed :style="style">\n        <v-icon :size="height/5">{{[\'filter_1\', \'filter_2\', \'filter_3\'][layers]}}</v-icon>\n      </v-btn>\n    </v-flex>\n    <v-flex xs2 d-flex style="padding:0%">\n      <v-btn\n        @click.native.stop.prevent="option.mirror=!option.mirror"\n        @touchstart.native.stop.prevent="option.mirror=!option.mirror"\n        :color="option.mirror?\'primary\':\'\'"\n        depressed\n        :style="style"\n      >\n        <v-icon :size="height/5">flip</v-icon>\n      </v-btn>\n    </v-flex>\n    <v-flex xs2 d-flex style="padding:0%">\n      <v-btn\n        @click.native.stop.prevent="cuber.controller.lock=!cuber.controller.lock"\n        @touchstart.native.stop.prevent="cuber.controller.lock=!cuber.controller.lock"\n        :color="cuber.controller.lock?\'primary\':\'\'"\n        depressed\n        :style="style"\n      >\n        <v-icon :size="height/5">{{cuber.controller.lock?\'lock\':\'lock_open\'}}</v-icon>\n      </v-btn>\n    </v-flex>\n    <v-flex xs2 d-flex style="padding:0%">\n      <v-btn @click.native.stop.prevent="check()" @touchstart.native.stop.prevent="check()" :color="assistant?\'primary\':\'\'" depressed :style="style">\n        <v-icon :size="height/5">assistant</v-icon>\n      </v-btn>\n    </v-flex>\n    <v-flex xs2 d-flex style="padding:0%">\n      <v-btn\n        @click.native.stop.prevent="cuber.left=!cuber.left"\n        @touchstart.native.stop.prevent="cuber.left=!cuber.left"\n        :color="cuber.left?\'primary\':\'\'"\n        depressed\n        :style="style"\n      >\n        <v-icon :size="height/5">switch_camera</v-icon>\n      </v-btn>\n    </v-flex>\n    <v-flex xs2 d-flex style="padding:0%">\n      <v-btn\n        depressed\n        :disabled="cuber.cube.history.length == 0 || cuber.controller.lock"\n        @click.native.stop.prevent="reverse()"\n        @touchstart.native.stop.prevent="reverse()"\n        :style="style"\n      >\n        <v-icon :size="height/5">backspace</v-icon>\n      </v-btn>\n    </v-flex>\n    <v-flex v-for="exp in exps" d-flex xs2 style="padding:0%">\n      <v-btn depressed @click.native.stop.prevent="twist(exp)" @touchstart.native.stop.prevent="twist(exp)" :disabled="cuber.controller.lock" :style="style"\n        ><div :style="{\'font-size\':(height/8)+\'px\'}">{{exp}}</div>\n      </v-btn>\n    </v-flex>\n  </v-layout>\n</v-container>\n'},function(e,t){e.exports='<v-bottom-sheet v-model="value">\n  <v-card flat style="margin: auto;touch-action: none;user-select: none;">\n    <v-container fluid grid-list-md text-xs-center>\n      <v-layout row wrap justify-center align-center>\n        <v-slider v-model="option.scale" always-dirty thumb-label="always" max="100" min="0" label="缩放"></v-slider>\n      </v-layout>\n      <v-layout row wrap justify-center align-center>\n        <v-slider v-model="option.perspective" always-dirty thumb-label="always" max="100" min="0" label="透视"></v-slider>\n      </v-layout>\n      <v-layout row wrap justify-center align-center>\n        <v-slider v-model="option.angle" always-dirty thumb-label="always" max="100" min="0" label="角度"></v-slider>\n      </v-layout>\n      <v-layout row wrap justify-center align-center>\n        <v-slider v-model="option.gradient" always-dirty thumb-label="always" max="100" min="0" label="梯度"></v-slider>\n      </v-layout>\n      <v-layout row wrap justify-center align-center>\n        <v-btn @click.native.stop.prevent="option.reset" @touchstart.native.stop.prevent="option.reset" outlined color="red">重置</v-btn>\n      </v-layout>\n    </v-container>\n  </v-card>\n</v-bottom-sheet>\n'},function(e){e.exports=JSON.parse('[{"strips":[{"indexes":[6,7,8,15,16,17,24,25,26],"faces":[0,1,2,3,4,5]}],"algs":[{"name":"F2L-01","alg":"(R\'FRF\')"},{"name":"F2L-02","alg":"y\'(U\'R\'UR)"},{"name":"F2L-03","alg":"y\'(R\'U\'R)"},{"name":"F2L-04","alg":"(RUR\')"},{"name":"F2L-05","alg":"U\'(RUR\') U2(RU\'R\')"},{"name":"F2L-06","alg":"d(R\'U\'R) U2(R\'UR)"},{"name":"F2L-07","alg":"U\'(RU\'2) (R\'U2) (RU\'R\')"},{"name":"F2L-08","alg":"d(R\'U2) (RU\'2) (R\'UR)"},{"name":"F2L-09","alg":"U\'(RU\'R\'U) (F\'U\'F)"},{"name":"F2L-10","alg":"U\'(RUR\'U) (RUR\')"},{"name":"F2L-11","alg":"U\'(RU2R\'U) (F\'U\'F)"},{"name":"F2L-12","alg":"(RU\'R\'U) (RU\'R\'U2) (RU\'R\')"},{"name":"F2L-13","alg":"d(R\'URU\') (R\'U\'R)"},{"name":"F2L-14","alg":"U\'(RU\'R\'U) (RUR\')"},{"name":"F2L-15","alg":"(RUR\'U2) (RU\'R\'U) (RU\'R\')"},{"name":"F2L-16","alg":"(RU\'R\'U) d(R\'U\'R)"},{"name":"F2L-17","alg":"(RU\'2) (R\'U\'RUR\')"},{"name":"F2L-18","alg":"y\'(R\'U2) (RUR\'U\'R)"},{"name":"F2L-19","alg":"U(RU\'2)(R\'URU\')R\'"},{"name":"F2L-20","alg":"y\'(U\'R\'U2) (RU\'R\'UR)"},{"name":"F2L-21","alg":"(RU\'R\'U2) (RUR\')"},{"name":"F2L-22","alg":"(F\'L\') U2(LF)"},{"name":"F2L-23","alg":"(RUR\'U2) (RUR\'U\') (RUR\')"},{"name":"F2L-24","alg":"F(URU\'R\') (F\'RU\'R\')"},{"name":"F2L-25","alg":"(R\'F\'RU) (RU\'R\'F)"},{"name":"F2L-26","alg":"U(RU\'R\'U\') (F\'UF)"},{"name":"F2L-27","alg":"(RU\'R\'U) (RU\'R\')"},{"name":"F2L-28","alg":"(RUR\'U\') (FR\'F\'R)"},{"name":"F2L-29","alg":"(R\'FRF\') (URU\'R\')"},{"name":"F2L-30","alg":"(RUR\'U\') (RUR\')"},{"name":"F2L-31","alg":"U\'(R\'FRF\') (RU\'R\')"},{"name":"F2L-32","alg":"(RUR\'U\')2 (RUR\')"},{"name":"F2L-33","alg":"(RUR\'U\') (RU\'R\'U) (RU\'R\')"},{"name":"F2L-34","alg":"U(RUR\'U2) (RUR\')"},{"name":"F2L-35","alg":"U\'(RUR\') (F\'U\'F)"},{"name":"F2L-36","alg":"U2(R\'FRF\') U2(RUR\')"},{"name":"F2L-37","alg":"(R\'FRF\') (RU\'R\'U) (RU\'R\'U2) (RU\'R\')"},{"name":"F2L-38","alg":"(RUR\'U\') (RU2R\'U\') (RUR\')"},{"name":"F2L-39","alg":"(RU\'R\'U) (RU\'2R\'U) (RU\'R\')"},{"name":"F2L-40","alg":"(RU\'R\'F) (RUR\'U\') (F\'RU\'R\')"},{"name":"F2L-41","alg":"(RUR\'U\') (RU\'R\'U2) y\'(R\'U\'R)"}]},{"strips":[{"indexes":[0,1,2,3,4,5,9,10,11,12,14,18,19,20,21,22,23],"faces":[0,1,2,3,4,5]},{"indexes":[6,7,8,15,16,17,24,25,26],"faces":[0,1,2,4,5]}],"algs":[{"name":"OLL-01","alg":"(RU\'2) (R2\'FRF\') U2(R\'FRF\')"},{"name":"OLL-02","alg":"(FRUR\'U\'F\') (fRUR\'U\'f\')"},{"name":"OLL-03","alg":"f(RUR\'U\')f\' U\'F(RUR\'U\')F\'"},{"name":"OLL-04","alg":"f(RUR\'U\') yxR\' F(RUR\'U\')F\'"},{"name":"OLL-05","alg":"r\'(U2) (RUR\'U)r"},{"name":"OLL-06","alg":"r(U\'2) (R\'U\'RU\')r\'"},{"name":"OLL-07","alg":"rUR\'URU\'2r\'"},{"name":"OLL-08","alg":"r\'U\'RU\'R\'U2r"},{"name":"OLL-09","alg":"(R\'U\'R) y\'x\'(RU\'R\'F) (RUR\')"},{"name":"OLL-10","alg":"(RUR\'U) (R\'FRF\') (RU\'2R\')"},{"name":"OLL-11","alg":"r\'(R2UR\'U) (RU\'2R\'U) (rR\')"},{"name":"OLL-12","alg":"L2lU\'z(UR\'U\') (R2UR\')z\'rR\'"},{"name":"OLL-13","alg":"(rU\'r\'U\') (rUr\') (F\'UF)"},{"name":"OLL-14","alg":"R\'FRUR\'F\'R (FU\'F\')"},{"name":"OLL-15","alg":"(r\'U\'r) (R\'U\'RU) (r\'Ur)"},{"name":"OLL-16","alg":"RBR\'L UL\'U\'RB\'R\'"},{"name":"OLL-17","alg":"(RUR\'U) (R\'FRF\'U2) (R\'FRF\')"},{"name":"OLL-18","alg":"F(RUR\'d) (R\'U2) (R\'FRF\')"},{"name":"OLL-19","alg":"R\'U2F RUR\'U\' y\'R2U\'2RBy"},{"name":"OLL-20","alg":"r\'(RU)(RUR\'U\'r2) (R2\'U)(RU\')r\'"},{"name":"OLL-21","alg":"(RU\'2)(R\'U\'RUR\'U\') (RU\'R\')"},{"name":"OLL-22","alg":"RU\'2(R\'2U\') (R2U\') R\'2U\'2R"},{"name":"OLL-23","alg":"(R2D\')(RU2) (R\'D)(RU2R)"},{"name":"OLL-24","alg":"(rUR\'U\') (r\'FRF\')"},{"name":"OLL-25","alg":"F\'(rUR\'U\') (r\'FR)"},{"name":"OLL-26","alg":"RU\'2R\'U\' RU\'R\'"},{"name":"OLL-27","alg":"R\'U2 RUR\'UR"},{"name":"OLL-28","alg":"(rUR\'U\')(r\'RU) (RU\'R\')"},{"name":"OLL-29","alg":"(R2U\'R) F(R\'U) (R2U\')(R\'F\'R)"},{"name":"OLL-30","alg":"(R2UR\'B\')(RU\') (R2\'U)(lUl\')"},{"name":"OLL-31","alg":"(r\'F\'UF) (LF\'L\'U\'r)"},{"name":"OLL-32","alg":"(RU)(B\'U\') (R\'URBR\')"},{"name":"OLL-33","alg":"(RUR\'U\') (R\'FRF\')"},{"name":"OLL-34","alg":"(R\'U\'RU) x\'z\'(RU)(L\'U\')rR\'"},{"name":"OLL-35","alg":"RU\'2R2\'FRF\' (RU\'2R\')"},{"name":"OLL-36","alg":"R\'U\'RU\'R\' URUlU\'R\'Ux"},{"name":"OLL-37","alg":"F(RU\'R\'U\'RU) (R\'F\')"},{"name":"OLL-38","alg":"(RUR\'U)(RU\'R\'U\') (R\'FRF\')"},{"name":"OLL-39","alg":"(LF\'L\'U\'LU) (FU\'L\')"},{"name":"OLL-40","alg":"(R\'FRUR\'U\') (F\'UR)"},{"name":"OLL-41","alg":"RU\'R\'U2RU yRU\'R\'U\'F\'"},{"name":"OLL-42","alg":"(R\'URU\'2R\'U\') (F\'U)(FUR)"},{"name":"OLL-43","alg":"(B\'U\') (R\'URB)"},{"name":"OLL-44","alg":"f(RUR\'U\')f\'"},{"name":"OLL-45","alg":"F(RUR\'U\')F\'"},{"name":"OLL-46","alg":"(R\'U\')R\'F RF\'(UR)"},{"name":"OLL-47","alg":"B\'(R\'U\'RU) (R\'U\'RU)B"},{"name":"OLL-48","alg":"F(RUR\'U\')2F\'"},{"name":"OLL-49","alg":"RB\'(R2F) (R2B)R2F\'R"},{"name":"OLL-50","alg":"L\'B(L2F\') (L2B\')L2FL\'"},{"name":"OLL-51","alg":"f(RUR\'U\')2f\'"},{"name":"OLL-52","alg":"R\'U\'RU\'R\' dR\'UlUxy"},{"name":"OLL-53","alg":"(r\'U2)(RUR\'U\') (RUR\'U)r"},{"name":"OLL-54","alg":"(rU\'2)(R\'U\'RUR\'U\') (RU\'r\')"},{"name":"OLL-55","alg":"(RU\'2)(R\'2U\') RU\'R\'U2 (FRF\')"},{"name":"OLL-56","alg":"F(RUR\'U\')(RF\') (rUR\'U\')r\'"},{"name":"OLL-57","alg":"(RUR\'U\'r)(R\'U) (RU\'r\')"}]},{"strips":[{"indexes":[0,1,2,3,4,5,9,10,11,12,14,18,19,20,21,22,23],"faces":[0,1,2,3,4,5]}],"algs":[{"name":"PLL-Aa","alg":"x(R2U\'2) (R\'D\') (RU\'2) (R\'DR\')x\'"},{"name":"PLL-Ab","alg":"x(RD\'R) (U2R\'D) (RU2R\'2)x\'"},{"name":"PLL-E ","alg":"x\'(RU\'R\'D) (RUR\') u2\'(R\'URD) (R\'U\'R)x\'"},{"name":"PLL-F ","alg":"(R\'U\'F\') (RUR\'U\') (R\'FR2U\'R\'U\') (RUR\'UR)"},{"name":"PLL-Ga","alg":"(R2uR\') (UR\'U\'Ru\') (R\'2F\'UF)"},{"name":"PLL-Gb","alg":"(R\'d\'F) (R2u) (R\'URU\'Ru\'R\'2)"},{"name":"PLL-Gc","alg":"(R\'2u\'RU\'R) (UR\'u) (R2fR\'f\')"},{"name":"PLL-Gd","alg":"(RUR\')y\' (R2u\'RU\'R\'U) (R\'uR2)"},{"name":"PLL-H ","alg":"M2U M2U2 M2U M2"},{"name":"PLL-Ja","alg":"z(U\'RD\') (R2UR\'U\') (R2UDR\')z\'"},{"name":"PLL-Jb","alg":"(RUR\'F\') (RUR\'U\') (R\'F) (R2U\'R\')"},{"name":"PLL-Na","alg":"z(R\'UR\') z\'(RU2L\'UR\') z(UR\') z\'(RU2L\'UR\')"},{"name":"PLL-Nb","alg":"z(U\'RD\') (R2UR\'U\') z\'(RUR\') z(R2UR\') z\'(RU\')"},{"name":"PLL-Ra","alg":"(RU\'2) (R\'U2) (RB\'R\'U\') (RURBR2\'U)"},{"name":"PLL-Rb","alg":"(R\'U2) (RU\'2) (R\'FRUR\'U\') (R\'F\'R2U\')"},{"name":"PLL-T ","alg":"(RUR\'U\') (R\'F) (R2U\'R\'U\') (RUR\'F\')"},{"name":"PLL-Ua","alg":"(RU\'R) (URUR) (U\'R\'U\'R2)"},{"name":"PLL-Ub","alg":"(R2U) (RUR\'U\') (R\'U\') (R\'UR\')"},{"name":"PLL-V ","alg":"(R\'UR\'U\'yx2) (R\'UR\'U\'yx) (U2R\'U\'RUR)x"},{"name":"PLL-Y ","alg":"F(RU\'R\'U\') (RUR\'F\') (RUR\'U\') (R\'FRF\')"},{"name":"PLL-Z ","alg":"(R\'U\'RU\'R) (URU\'R\'UR) (UR2U\'R\')"}]}]')},function(e,t){e.exports='<v-dialog v-model="value" scrollable>\n  <v-card outline>\n    <v-card-text>\n      <v-progress-linear v-if="blobs.length!=119" indeterminate height="60"></v-progress-linear>\n      <v-container v-if="blobs.length==119" fluid grid-list-md text-xs-center style="padding:0%;">\n        <v-layout row wrap style="margin: 0%; padding:0%; min-width: 0%; min-height: 0%;">\n          <v-flex v-for="blob in blobs" d-flex xs4 style="padding:0%">\n            <v-img contain :src="URL.createObjectURL(blob)"></v-img>\n          </v-flex>\n        </v-layout>\n      </v-container>\n    </v-card-text>\n  </v-card>\n</v-dialog>\n'},function(e,t){e.exports='<v-app>\n  <v-speed-dial v-model="menu" fixed top right direction="bottom" style="user-select: none;">\n    <template v-slot:activator>\n      <v-btn\n        @click.native.stop.prevent="menu=!menu"\n        @touchstart.native.stop.prevent="menu=!menu"\n        fab\n        depressed\n        color="primary"\n        :style="{width:size+\'px\', height:size+\'px\'}"\n      >\n        <v-icon v-if="menu" :size="size * 0.6">close</v-icon>\n        <v-icon v-else :size="size * 0.6">menu</v-icon>\n      </v-btn>\n    </template>\n    <v-btn\n      fab\n      depressed\n      color="white"\n      :style="{width:size*0.9+\'px\', height:size*0.9+\'px\'}"\n      @click.native.stop.prevent="alg=true;menu=false;"\n      @touchstart.native.stop.prevent="alg=true;menu=false;"\n    >\n      <v-icon :size="size * 0.55" color="indigo">school</v-icon>\n    </v-btn>\n    <v-btn\n      fab\n      depressed\n      color="white"\n      :style="{width:size*0.9+\'px\', height:size*0.9+\'px\'}"\n      @click.native.stop.prevent="cuber.cube.twister.twist(\'*\');menu=false;"\n      @touchstart.native.stop.prevent="cuber.cube.twister.twist(\'*\');menu=false;"\n    >\n      <v-icon :size="size * 0.55" color="red">casino</v-icon>\n    </v-btn>\n    <v-btn\n      fab\n      depressed\n      color="white"\n      :style="{width:size*0.9+\'px\', height:size*0.9+\'px\'}"\n      @click.native.stop.prevent="tune=true;menu=false;"\n      @touchstart.native.stop.prevent="tune=true;menu=false;"\n    >\n      <v-icon :size="size * 0.55" color="indigo">tune</v-icon>\n    </v-btn>\n  </v-speed-dial>\n  <div v-resize="resize" style="background-color: #CCC;user-select: none;">\n    <div ref="cuber"></div>\n    <div style="margin:0%;padding:0%;"><keyboard ref="keyboard"></keyboard></div>\n  </div>\n  <tune v-model="tune"></tune>\n  <alg v-model="alg"></alg>\n</v-app>\n'},function(e,t,i){e.exports=i(3)(57)},function(e,t,i){e.exports=i(3)(29)},function(e,t,i){e.exports=i(3)(31)},function(e,t,i){"use strict";i.r(t);var s=i(2),r=i(1),n=i(0);var a=new class{constructor(){this.tweens=[],this.loop()}get length(){return this.tweens.length}loop(){requestAnimationFrame(this.loop.bind(this)),this.update()}tween(e,t,i,s){this.tweens.push(new o(e,t,i,s))}update(){if(0===this.tweens.length)return!1;for(var e=0;e<this.tweens.length;)this.tweens[e].update()?e++:this.tweens.splice(e,1);return!0}speedup(){for(const e of this.tweens)e.speedup()}finish(){let e=this.tweens.splice(0,this.tweens.length);for(const t of e)t.finish()}};class o{constructor(e,t,i,s){this.begin=e,this.end=t,this.duration=i,this.callback=s,this.value=0,this.delta=1}speedup(){this.delta=4}finish(){this.callback(this.end)}update(){this.value=this.value+this.delta;let e=this.value/this.duration;e=e>1?1:e,e=e<0?0:e,e-=1;let t=1-e*e;return this.callback(this.begin+(this.end-this.begin)*t),1!=t}}var h,l="#092",c="#E60",u="#25D",d="#FC0",R="#EEE",p="#C00",g="#888",U="#222",v="#CCC";!function(e){e[e.L=0]="L",e[e.R=1]="R",e[e.D=2]="D",e[e.U=3]="U",e[e.B=4]="B",e[e.F=5]="F"}(h||(h={}));class m{constructor(e){this.cube=e,this.queue=[]}static shuffle(){let e="",t=[],i=-1,s=["U","D","R","L","F","B"],r=-1;for(let e=0;e<24;e++){let e=[];for(;r==i;)r=Math.floor(3*Math.random());let n=Math.floor(2*Math.random());e.push(s[2*r+n]);let a=Math.random();a<.2?e.push("2"):a<.6&&e.push("'"),t.push(e.join("")),i=r}return e=t.join(" "),e}get length(){return this.queue.length}finish(){for(const e of this.queue)e.fast=!0;a.finish()}twist(e,t=!1,i=1,s=!1){this.queue.length>0&&(a.finish(),this.update()),a.speedup();let r=new b(e,t,i).parse();for(let e of r)e.fast=s,this.queue.push(e);this.update()}update(){if(0===this.queue.length||this.cube.lock)return!1;let e=this.queue.shift();if(null==e)return!1;this.start(e)}start(e){if("-"==e.exp)return e.fast?void this.update():void a.tween(0,1,30*e.times,e=>{1!==e&&0!==e||this.update()});if("#"==e.exp)return this.cube.history.clear(),this.cube.reset(),this.cube.dirty=!0,void this.update();if("*"==e.exp){let e=m.shuffle();return this.twist(e,!1,1,!0),void this.cube.history.clear()}let t=-Math.PI/2;e.reverse&&(t=-t),e.times&&(t*=e.times);let i=this.cube.groups[e.exp];void 0!==i?(i.angle=0,i.hold(),e.fast&&(i.angle=t),i.twist(t,this.update.bind(this))):this.update()}}class f{constructor(e,t=!1,i=1,s=!1){this.exp=e,this.reverse=t,this.times=i,this.fast=s}get value(){return 0==this.times?"":(this.exp.length>1?"(":"")+this.exp+(this.exp.length>1?")":"")+(this.reverse?"'":"")+(1==this.times?"":String(this.times))}}class b{constructor(e,t=!1,i=1){if(this.children=[],e=e.replace(/[^\*#\-xyzbsfdeulmr\(\)'0123456789]/gi,""),this.twist=new f(e,t,i),1==e.length)return/[XYZ]/.test(this.twist.exp)&&(this.twist.exp=this.twist.exp.toLowerCase()),void(/[mes]/.test(this.twist.exp)&&(this.twist.exp=this.twist.exp.toUpperCase()));let s=[],r="",n=0;for(let t=0;t<e.length;t++){let i=e.charAt(t);if(0==r.length){if(b._ACTIONS.indexOf(i)>=0){r=r.concat(i);continue}if("("===i){r=r.concat(i),n++;continue}return}0==n?b._SUFFIX.indexOf(i)>=0?r=r.concat(i):(s.push(r),r="",t--):("("===i?n++:")"===i&&n--,r=r.concat(i))}if(r.length>0&&s.push(r),0!=s.length)for(let e of s){var a=e.match(/^\((\S+)\)('?)(\d*)('?)$/i);if(null===a&&(a=e.match(/([\*#\-xyzbsfdeulmr])('?)(\d*)('?)/i)),null===a)return;let t=1==(a[2]+a[4]).length,i=0==a[3].length?1:parseInt(a[3]);this.children.push(new b(a[1],t,i))}}parse(e=!1){e=this.twist.reverse!==e;let t=[];if(0!==this.children.length)for(var i=0;i<this.twist.times;i++)for(var s=0;s<this.children.length;s++){var r=(e?this.children[this.children.length-s-1]:this.children[s]).parse(e);for(let e of r)t.push(e)}else if(""!=this.twist.exp){let i=new f(this.twist.exp,e,this.twist.times);t.push(i)}return t}get value(){return this.twist.value}}b._ACTIONS="*#-xyzbsfdeulmrXYZBFSDEULMR",b._SUFFIX="'0123456789";class y extends n.Group{constructor(e,t,i,s){super(),this.cube=e,this._angle=0,this.cubelets=[],this.name=t,this.indices=i,this.axis=s,this.matrixAutoUpdate=!1,this.updateMatrix()}set angle(e){this.setRotationFromAxisAngle(this.axis,e),this._angle=e,this.updateMatrix(),this.cube.dirty=!0}get angle(){return this._angle}hold(){this.angle=0;for(let e of this.indices){let t=this.cube.cubelets[e];this.cubelets.push(t),this.cube.remove(t),this.add(t)}this.cube.lock=!0}drop(){for(this.angle=Math.round(this.angle/(Math.PI/2))*(Math.PI/2);;){let e=this.cubelets.pop();if(void 0===e)break;this.rotate(e),this.remove(e),this.cube.add(e),this.cube.cubelets[e.index]=e}this.cube.lock=!1,this.angle=0}twist(e=this.angle,t=null){e=Math.round(e/(Math.PI/2))*(Math.PI/2);let i=this.name,s=e>0,r=Math.round(Math.abs(e)/(Math.PI/2));0!=r&&this.cube.history.record(new f(i,s,r));let n=e-this.angle;if(0===n)this.drop(),t&&t();else{var o=30*Math.min(1,Math.abs(n)/(Math.PI/2));a.tween(this.angle,e,o,i=>{this.angle=i,this.angle!==e&&0!==this.angle||(this.drop(),t&&t())})}}rotate(e){e.rotateOnWorldAxis(this.axis,this.angle),e.vector=e.vector.applyAxisAngle(this.axis,this.angle),e.updateMatrix()}}class x extends n.Geometry{constructor(e,t){super();const i=e/2,s=i-t,r=[[-s,+s,+i],[+s,+s,+i],[+s,-s,+i],[-s,-s,+i],[-s,+i,-s],[+s,+i,-s],[+s,+i,+s],[-s,+i,+s],[-i,-s,-s],[-i,+s,-s],[-i,+s,+s],[-i,-s,+s],[+s,+s,-i],[-s,+s,-i],[-s,-s,-i],[+s,-s,-i],[-s,-i,+s],[+s,-i,+s],[+s,-i,-s],[-s,-i,-s],[+i,+s,+s],[+i,+s,-s],[+i,-s,-s],[+i,-s,+s]];for(let e=0;e<r.length;e++){let t=r[e];this.vertices.push(new n.Vector3(t[0],t[1],t[2]))}for(let e=0;e<x._INDICES.length;e++){let t=x._INDICES[e],i=new n.Face3(t[0],t[1],t[2]);this.faces.push(i)}this.computeFaceNormals()}}x._INDICES=[[1,6,7],[0,1,7],[3,0,10],[11,3,10],[17,2,3],[16,17,3],[23,20,1],[2,23,1],[5,12,13],[4,5,13],[9,13,14],[8,9,14],[22,15,12],[21,22,12],[19,14,15],[18,19,15],[7,4,9],[10,7,9],[11,8,19],[16,11,19],[23,17,18],[22,23,18],[20,21,5],[6,20,5],[20,6,1],[10,0,7],[21,12,5],[13,9,4],[23,2,17],[11,16,3],[22,18,15],[8,14,19]];class L extends n.ShapeGeometry{constructor(e,t){e/=2;let i=-(e-=t),s=e,r=-e,a=e,o=e/4,h=new n.Shape;h.moveTo(i,r+o),h.lineTo(i,s-o),h.quadraticCurveTo(i,s,i+o,s),h.lineTo(a-o,s),h.quadraticCurveTo(a,s,a,s-o),h.lineTo(a,r+o),h.quadraticCurveTo(a,r,a-o,r),h.lineTo(i+o,r),h.quadraticCurveTo(i,r,i,r+o),h.closePath(),super(h)}}class w extends n.ShapeGeometry{constructor(e,t){let i=new n.Shape;e/=2,i.moveTo(-e,-e),i.lineTo(-e,e),i.lineTo(e,e),i.lineTo(e,-e),i.closePath();let s=-(e-=t),r=e,a=-e,o=e,h=e/4,l=new n.Shape;l.moveTo(s,a+h),l.quadraticCurveTo(s,a,s+h,a),l.lineTo(o-h,a),l.quadraticCurveTo(o,a,o,a+h),l.lineTo(o,r-h),l.quadraticCurveTo(o,r,o-h,r),l.lineTo(s+h,r),l.quadraticCurveTo(s,r,s,r-h),l.lineTo(s,a+h),l.closePath(),i.holes.push(l),super(i)}}class F extends n.Group{constructor(e){super(),this.initial=e,this._vector=new n.Vector3,this.stickers=[],this.edges=[],this._quaternion=new n.Quaternion,this.mirrors=[];let t=e%3-1,i=Math.floor(e%9/3)-1,s=Math.floor(e/9)-1;this.vector=new n.Vector3(t,i,s),this.materials=[this.vector.x<0?F._MATERIALS.orange:F._MATERIALS.gray,this.vector.x>0?F._MATERIALS.red:F._MATERIALS.gray,this.vector.y<0?F._MATERIALS.white:F._MATERIALS.gray,this.vector.y>0?F._MATERIALS.yellow:F._MATERIALS.gray,this.vector.z<0?F._MATERIALS.green:F._MATERIALS.gray,this.vector.z>0?F._MATERIALS.blue:F._MATERIALS.gray],this.frame=new n.Mesh(F._FRAME,F._MATERIALS.black),this.add(this.frame);for(let e=0;e<6;e++){let t=new n.Mesh(F._EDGE,F._MATERIALS.black),i=new n.Mesh(F._STICKER,this.materials[e]);switch(e){case h.L:t.rotation.y=-Math.PI/2,t.position.x=-F.SIZE/2,i.rotation.y=-Math.PI/2,i.position.x=-F.SIZE/2,i.name="L";break;case h.R:t.rotation.y=Math.PI/2,t.position.x=F.SIZE/2,i.rotation.y=Math.PI/2,i.position.x=F.SIZE/2,i.name="R";break;case h.D:t.rotation.x=Math.PI/2,t.position.y=-F.SIZE/2,i.rotation.x=Math.PI/2,i.position.y=-F.SIZE/2,i.name="D";break;case h.U:t.rotation.x=-Math.PI/2,t.position.y=F.SIZE/2,i.rotation.x=-Math.PI/2,i.position.y=F.SIZE/2,i.name="U";break;case h.B:t.rotation.x=Math.PI,t.position.z=-F.SIZE/2,i.rotation.x=Math.PI,i.position.z=-F.SIZE/2,i.name="B";break;case h.F:t.rotation.z=0,t.position.z=F.SIZE/2,i.rotation.x=2*Math.PI,i.position.z=F.SIZE/2,i.name="F"}if(this.add(t),this.edges.push(t),this.add(i),this.stickers.push(i),this.materials[e]!=F._MATERIALS.gray){let t=new n.Mesh(F._STICKER,this.materials[e]);t.rotation.x=0==i.rotation.x?0:i.rotation.x+Math.PI,t.rotation.y=0==i.rotation.y?0:i.rotation.y+Math.PI,t.rotation.z=0==i.rotation.z?0:i.rotation.z+Math.PI,t.rotation.x+t.rotation.y+t.rotation.z==0&&(t.rotation.y=Math.PI),t.position.x=3*i.position.x,t.position.y=3*i.position.y,t.position.z=3*i.position.z,this.add(t),this.mirrors[e]=t}this.matrixAutoUpdate=!1,this.updateMatrix()}}set vector(e){this._vector.set(Math.round(e.x),Math.round(e.y),Math.round(e.z)),this._index=9*(this._vector.z+1)+3*(this._vector.y+1)+(this._vector.x+1),this.position.x=F.SIZE*this._vector.x,this.position.y=F.SIZE*this._vector.y,this.position.z=F.SIZE*this._vector.z}get vector(){return this._vector}set index(e){let t=e%3-1,i=Math.floor(e%9/3)-1,s=Math.floor(e/9)-1;this.vector=new n.Vector3(t,i,s)}get index(){return this._index}set mirror(e){if(e)for(let e=0;e<6;e++)this.mirrors[e]instanceof n.Mesh&&this.children.indexOf(this.mirrors[e])<0&&this.add(this.mirrors[e]);else for(let e=0;e<6;e++)this.mirrors[e]instanceof n.Mesh&&this.children.indexOf(this.mirrors[e])>=0&&this.remove(this.mirrors[e])}getColor(e){let t=new n.Vector3(0,0,0);switch(e){case h.L:t.x=-1;break;case h.R:t.x=1;break;case h.D:t.y=-1;break;case h.U:t.y=1;break;case h.B:t.z=-1;break;case h.F:t.z=1}this._quaternion.copy(this.quaternion),t.applyQuaternion(this._quaternion.inverse());let i=Math.round(t.x),s=Math.round(t.y),r=Math.round(t.z),a=0;return i<0?a=h.L:i>0?a=h.R:s<0?a=h.D:s>0?a=h.U:r<0?a=h.B:r>0&&(a=h.F),a}stick(e,t){let i;i=t.length>0?new n.MeshBasicMaterial({color:t}):this.materials[e],this.stickers[e].material=i,this.mirrors[e]instanceof n.Mesh&&(this.mirrors[e].material=i)}}F.SIZE=64,F._BORDER_WIDTH=3,F._EDGE_WIDTH=2,F._FRAME=new x(F.SIZE,F._BORDER_WIDTH),F._EDGE=new w(F.SIZE-2*F._BORDER_WIDTH,F._EDGE_WIDTH),F._STICKER=new L(F.SIZE-2*F._BORDER_WIDTH,F._EDGE_WIDTH),F._MATERIALS={green:new n.MeshBasicMaterial({color:l}),orange:new n.MeshBasicMaterial({color:c}),blue:new n.MeshBasicMaterial({color:u}),yellow:new n.MeshBasicMaterial({color:d}),white:new n.MeshBasicMaterial({color:R}),red:new n.MeshBasicMaterial({color:p}),gray:new n.MeshBasicMaterial({color:g}),black:new n.MeshBasicMaterial({color:U})};class M{constructor(){this.list=[],this.callbacks=[]}record(e){if(0==this.list.length)this.list.push(e);else{let t=this.list[this.list.length-1];t.exp==e.exp&&t.times==e.times&&t.reverse!=e.reverse?this.list.pop():this.list.push(e)}for(let e of this.callbacks)e()}clear(){this.list=[];for(let e of this.callbacks)e()}get last(){return this.list[this.list.length-1]}get length(){return this.list.length}}class I extends n.Group{constructor(){super(),this.dirty=!0,this.lock=!1,this.history=new M,this.cubelets=[],this.initials=[],this.twister=new m(this);for(var e=0;e<27;e++){let t=new F(e);this.cubelets.push(t),this.initials.push(t),this.add(t)}this.groups={L:new y(this,"L",[6,15,24,3,12,21,0,9,18],new n.Vector3(-1,0,0)),D:new y(this,"D",[18,19,20,9,10,11,0,1,2],new n.Vector3(0,-1,0)),B:new y(this,"B",[8,7,6,5,4,3,2,1,0],new n.Vector3(0,0,-1)),R:new y(this,"R",[26,17,8,23,14,5,20,11,2],new n.Vector3(1,0,0)),U:new y(this,"U",[6,7,8,15,16,17,24,25,26],new n.Vector3(0,1,0)),F:new y(this,"F",[24,25,26,21,22,23,18,19,20],new n.Vector3(0,0,1)),l:new y(this,"l",[0,3,6,9,12,15,18,21,24,1,4,7,10,13,16,19,22,25],new n.Vector3(-1,0,0)),d:new y(this,"d",[0,1,2,9,10,11,18,19,20,3,4,5,12,13,14,21,22,23],new n.Vector3(0,-1,0)),b:new y(this,"b",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],new n.Vector3(0,0,-1)),r:new y(this,"r",[2,5,8,11,14,17,20,23,26,1,4,7,10,13,16,19,22,25],new n.Vector3(1,0,0)),u:new y(this,"u",[6,7,8,15,16,17,24,25,26,3,4,5,12,13,14,21,22,23],new n.Vector3(0,1,0)),f:new y(this,"f",[18,19,20,21,22,23,24,25,26,9,10,11,12,13,14,15,16,17],new n.Vector3(0,0,1)),M:new y(this,"M",[1,4,7,10,13,16,19,22,25],new n.Vector3(-1,0,0)),E:new y(this,"E",[3,4,5,12,13,14,21,22,23],new n.Vector3(0,-1,0)),S:new y(this,"S",[9,10,11,12,13,14,15,16,17],new n.Vector3(0,0,1)),x:new y(this,"x",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],new n.Vector3(1,0,0)),y:new y(this,"y",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],new n.Vector3(0,1,0)),z:new y(this,"z",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],new n.Vector3(0,0,1))};for(let e in this.groups)this.add(this.groups[e]);this.matrixAutoUpdate=!1,this.updateMatrix()}index(e){return this.initials[e].index}reset(){for(let e of this.cubelets)e.setRotationFromEuler(new n.Euler(0,0,0)),e.index=e.initial,e.updateMatrix();this.cubelets.sort((e,t)=>e.index-t.index)}stick(){for(let e=0;e<27;e++)for(let t=0;t<6;t++)this.initials[e].stick(t,"");this.dirty=!0}strip(e){this.stick();for(let t of e)for(let e of t.indexes)for(let i of t.faces)this.initials[e].stick(i,g);this.dirty=!0}get state(){let e=[];for(let t of this.groups.U.indices)e.push(this.cubelets[t].getColor(h.U));for(let t of this.groups.R.indices)e.push(this.cubelets[t].getColor(h.R));for(let t of this.groups.F.indices)e.push(this.cubelets[t].getColor(h.F));for(let t of this.groups.D.indices)e.push(this.cubelets[t].getColor(h.D));for(let t of this.groups.L.indices)e.push(this.cubelets[t].getColor(h.L));for(let t of this.groups.B.indices)e.push(this.cubelets[t].getColor(h.B));return e.join("")}}class _{constructor(){this.vector=new n.Vector3}}class z{constructor(e){this.dragging=!1,this.rotating=!1,this.angle=0,this.ray=new n.Ray,this.down=new n.Vector2(0,0),this.move=new n.Vector2(0,0),this.matrix=new n.Matrix4,this.holder=new _,this.vector=new n.Vector3,this.planes=[new n.Plane(new n.Vector3(1,0,0),3*-F.SIZE/2),new n.Plane(new n.Vector3(0,1,0),3*-F.SIZE/2),new n.Plane(new n.Vector3(0,0,1),3*-F.SIZE/2)],this._lock=!1,this._onMouseDown=e=>(this.down.x=e.offsetX,this.down.y=e.offsetY,this.handleDown(),e.returnValue=!1,!1),this._onMouseMove=e=>(this.move.x=e.offsetX,this.move.y=e.offsetY,this.handleMove(),e.returnValue=!1,!1),this._onMouseUp=e=>(this.handleUp(),e.returnValue=!1,!1),this._onMouseOut=e=>(this.handleUp(),e.returnValue=!1,!1),this._onTouch=e=>{let t=e.changedTouches[0];switch(e.type){case"touchstart":this.down.x=t.clientX,this.down.y=t.clientY,this.handleDown();break;case"touchmove":this.move.x=t.clientX,this.move.y=t.clientY,this.handleMove();break;case"touchend":this.handleUp();break;default:return}return e.returnValue=!1,!1},this.cuber=e,this.taps=[],this.cuber.canvas.addEventListener("mousedown",this._onMouseDown),this.cuber.canvas.addEventListener("mousemove",this._onMouseMove),this.cuber.canvas.addEventListener("mouseup",this._onMouseUp),this.cuber.canvas.addEventListener("mouseout",this._onMouseOut),this.cuber.canvas.addEventListener("touchstart",this._onTouch),this.cuber.canvas.addEventListener("touchmove",this._onTouch),this.cuber.canvas.addEventListener("touchend",this._onTouch),this.loop()}get lock(){return this._lock}set lock(e){this.handleUp(),this._lock=e}loop(){requestAnimationFrame(this.loop.bind(this)),this.update()}update(){if(this.lock&&this.rotating&&this.group.angle!=this.angle){let e=(this.angle-this.group.angle)/2,t=Math.PI/2/30*4;e>t&&(e=t),e<-t&&(e=-t),this.group.angle+=e,this.cuber.dirty=!0}}match(){let e,t=[];var i=this.holder.index;if(-1===this.holder.index)return e=this.cuber.cube.groups.x,0===e.axis.dot(this.holder.plane.normal)&&t.push(e),e=this.cuber.cube.groups.y,0===e.axis.dot(this.holder.plane.normal)&&t.push(e),e=this.cuber.cube.groups.z,0===e.axis.dot(this.holder.plane.normal)&&t.push(e),t;var s=i%3-1,r=Math.floor(i%9/3)-1,n=Math.floor(i/9)-1;switch(s){case-1:e=this.cuber.cube.groups.L,0===e.axis.dot(this.holder.plane.normal)&&t.push(e);break;case 0:e=this.cuber.cube.groups.M,0===e.axis.dot(this.holder.plane.normal)&&t.push(e);break;case 1:e=this.cuber.cube.groups.R,0===e.axis.dot(this.holder.plane.normal)&&t.push(e)}switch(r){case-1:e=this.cuber.cube.groups.D,0===e.axis.dot(this.holder.plane.normal)&&t.push(e);break;case 0:e=this.cuber.cube.groups.E,0===e.axis.dot(this.holder.plane.normal)&&t.push(e);break;case 1:e=this.cuber.cube.groups.U,0===e.axis.dot(this.holder.plane.normal)&&t.push(e)}switch(n){case-1:e=this.cuber.cube.groups.B,0===e.axis.dot(this.holder.plane.normal)&&t.push(e);break;case 0:e=this.cuber.cube.groups.S,0===e.axis.dot(this.holder.plane.normal)&&t.push(e);break;case 1:e=this.cuber.cube.groups.F,0===e.axis.dot(this.holder.plane.normal)&&t.push(e)}return t}intersect(e,t){var i=e.x/this.cuber.width*2-1,s=-e.y/this.cuber.height*2+1;this.ray.origin.setFromMatrixPosition(this.cuber.camera.matrixWorld),this.ray.direction.set(i,s,.5).unproject(this.cuber.camera).sub(this.ray.origin).normalize(),this.ray.applyMatrix4(this.matrix.identity().getInverse(this.cuber.scene.matrix));var r=new n.Vector3;return this.ray.intersectPlane(t,r),r}handleDown(){if(this.dragging||this.rotating)return;this.dragging=!0,this.holder.index=-1,a.speedup();let e=0;this.planes.forEach(t=>{var i=this.intersect(this.down,t);if(null!==i&&Math.abs(i.x)<=3*F.SIZE/2+.01&&Math.abs(i.y)<=3*F.SIZE/2+.01&&Math.abs(i.z)<=3*F.SIZE/2+.01){let a=Math.pow(i.x-this.ray.origin.x,2)+Math.pow(i.y-this.ray.origin.y,2)+Math.pow(i.z-this.ray.origin.z,2);if(0==e||a<e){this.holder.plane=t;var s=Math.ceil(Math.round(i.x)/F.SIZE-.5),r=Math.ceil(Math.round(i.y)/F.SIZE-.5),n=Math.ceil(Math.round(i.z)/F.SIZE-.5);return s<2&&s>-2&&r<2&&r>-2&&n<2&&n>-2?(this.holder.index=9*(n+1)+3*(r+1)+(s+1),13==this.holder.index&&(this.holder.index=-1)):this.holder.index=-1,void(e=a)}}},this)}handleMove(){if(this.dragging){var e=this.move.x-this.down.x,t=this.move.y-this.down.y,i=Math.sqrt(e*e+t*t);if(Math.min(this.cuber.width,this.cuber.height)/i>32)return!0;if(a.finish(),this.cuber.cube.lock)return this.dragging=!1,this.rotating=!1,!0;if(this.dragging=!1,this.rotating=!0,-1===this.holder.index)if(e*e>t*t)this.group=this.cuber.cube.groups.y;else{let e=new n.Vector3(3*F.SIZE/2,0,3*F.SIZE/2);e.applyMatrix4(this.cuber.scene.matrix).project(this.cuber.camera);let t=this.cuber.width/2,i=Math.round(e.x*t+t);this.down.x<i?this.group=this.cuber.cube.groups.x:this.group=this.cuber.cube.groups.z}else{var s=this.intersect(this.down,this.holder.plane),r=this.intersect(this.move,this.holder.plane);this.vector.subVectors(r,s);var o=this.vector.x,h=this.vector.y,l=this.vector.z,c=Math.max(Math.abs(o),Math.abs(h),Math.abs(l));o=Math.abs(o)===c?o:0,h=Math.abs(h)===c?h:0,l=Math.abs(l)===c?l:0,this.vector.set(o,h,l),this.holder.vector.copy(this.vector.multiply(this.vector).normalize()),this.match().some(e=>0===e.axis.dot(this.vector)&&(this.group=e,!0),this),this.vector.crossVectors(this.holder.vector,this.holder.plane.normal),this.holder.vector.multiplyScalar(this.vector.x+this.vector.y+this.vector.z)}this.group.hold()}if(this.rotating){if(-1===this.holder.index){e=this.move.x-this.down.x,t=this.move.y-this.down.y;this.group===this.cuber.cube.groups.y?this.angle=e/F.SIZE*Math.PI/4:this.group===this.cuber.cube.groups.x?this.angle=t/F.SIZE*Math.PI/4:this.angle=-t/F.SIZE*Math.PI/4}else{s=this.intersect(this.down,this.holder.plane),r=this.intersect(this.move,this.holder.plane);this.vector.subVectors(r,s).multiply(this.holder.vector),this.angle=-(this.vector.x+this.vector.y+this.vector.z)*(this.group.axis.x+this.group.axis.y+this.group.axis.z)/F.SIZE*Math.PI/4}if(!this.lock)return this.angle=0==this.angle?0:this.angle/Math.abs(this.angle)*Math.PI/2,void this.handleUp()}}handleUp(){if(this.dragging){let e=null;switch(this.holder.plane){case this.planes[0]:e=h.R;break;case this.planes[1]:e=h.U;break;case this.planes[2]:e=h.F}for(let t of this.taps)t(this.holder.index,e)}this.rotating&&this.group&&null!==this.group&&(this.lock?this.group.twist(0):this.group.twist(this.angle)),this.holder.index=-1,this.dragging=!1,this.rotating=!1,this.cuber.dirty=!0}}class O{constructor(e){this.dirty=!1,this._scale=1,this._angle=Math.PI/16,this._left=!1,this._gradient=Math.PI/6,this._perspective=1,this.canvas=e,this.controller=new z(this),this.cube=new I,this.renderer=new n.WebGLRenderer({canvas:e,antialias:!0}),this.renderer.autoClear=!1,this.renderer.setClearColor(v),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height,!0),this.scene=new n.Scene,this.scene.rotation.x=Math.PI/6,this.scene.rotation.y=-Math.PI/4+Math.PI/16,this.scene.add(this.cube),this.camera=new n.PerspectiveCamera(50,1,1,32*F.SIZE),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=0}get mirror(){return this._mirror}set mirror(e){this._mirror=e;for(let t of this.cube.cubelets)t.mirror=e;this.dirty=!0}get scale(){return this._scale}set scale(e){this._scale=e,this.resize()}get angle(){return this._angle}set angle(e){this._angle=e,this.scene.rotation.y=(e-Math.PI/4)*(this.left?-1:1),this.dirty=!0}get left(){return this._left}set left(e){this._left=e;let t=this.scene.rotation.y,i=(this.angle-Math.PI/4)*(e?-1:1);a.finish(),a.tween(t,i,15,e=>{this.scene.rotation.y=e,this.dirty=!0})}get gradient(){return this._gradient}set gradient(e){this._gradient=e,this.scene.rotation.x=e,this.dirty=!0}get perspective(){return this._perspective}set perspective(e){this._perspective=e,this.resize()}resize(){let e=this.height/Math.min(this.width,this.height/1.2)/4,t=2*Math.atan(e*this.scale/this.perspective)*180/Math.PI;this.camera.aspect=this.width/this.height,this.camera.fov=t,this.camera.position.z=3*F.SIZE*4*this.perspective,this.camera.lookAt(this.scene.position),this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height,!0),this.dirty=!0}render(){(this.dirty||this.cube.dirty)&&(this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.dirty=!1,this.cube.dirty=!1)}}class E{constructor(e){this._storage=window.localStorage,this.cuber=e,this.load()}load(){this.mirror="true"==this._storage.getItem("setting.mirror"),this.scale=Number(this._storage.getItem("setting.scale")||80),this.perspective=Number(this._storage.getItem("setting.perspective")||50),this.angle=Number(this._storage.getItem("setting.angle")||20),this.gradient=Number(this._storage.getItem("setting.gradient")||50)}reset(){this.mirror=!1,this.scale=80,this.perspective=50,this.angle=20,this.gradient=50}get mirror(){return this._mirror}set mirror(e){this._mirror=e,this._storage.setItem("setting.mirror",String(e)),this.cuber.mirror=e}get scale(){return this._scale}set scale(e){this._scale=e,this._storage.setItem("setting.scale",String(e)),e=.8-e/100,this.cuber.scale=Math.exp(e)}get perspective(){return this._perspective}set perspective(e){this._perspective=e,this._storage.setItem("setting.perspective",String(e)),e=1-Math.sqrt(e/100),this.cuber.perspective=2*e+.4}get angle(){return this._angle}set angle(e){this._angle=e,this._storage.setItem("setting.angle",String(e)),e/=100,this.cuber.angle=e}get gradient(){return this._gradient}set gradient(e){this._gradient=e,this._storage.setItem("setting.gradient",String(e)),e/=100,this.cuber.gradient=1-1.2*e}}var S=function(e,t,i,s){var r,n=arguments.length,a=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},P=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let k=class extends s.default{constructor(){super(...arguments),this.width=0,this.height=0,this.assistant=!1,this.layers=0,this.operations=[["L","D","B","F","U","R","L'","D'","B'","F'","U'","R'"],["l","d","b","f","u","r","l'","d'","b'","f'","u'","r'"],["M","E","S","z","y","x","M'","E'","S'","z'","y'","x'"]],this.strips=[[{indexes:[0,2,3,5,6,7,8,15,17,18,20,21,23,24,25,26],faces:[0,1,2,3,4,5]}],[{indexes:[6,7,8,15,16,17,24,25,26],faces:[0,1,2,3,4,5]}],[{indexes:[6,7,8,15,16,17,24,25,26],faces:[0,1,2,4,5]}],[]],this.faces={4:h.B,10:h.D,12:h.L,14:h.R,16:h.U,22:h.F}}check(){if(this.assistant=!this.assistant,this.assistant){let e,t,i=this.cuber.cube.initials[10],s=this.cuber.cube.initials[14],r=this.cuber.cube.initials[4],a=this.cuber.cube.initials[12],o=this.cuber.cube.initials[22],l=this.cuber.cube.initials[16],c=new n.Vector3;if(t=[s,r,a,o].every(t=>{c.copy(i.vector).add(t.vector),e=9*(c.z+1)+3*(c.y+1)+(c.x+1);let s=this.cuber.cube.cubelets[e];if(s.getColor(this.faces[i.index])==h.D&&s.getColor(this.faces[t.index])==this.faces[t.initial])return!0}),!t)return void this.cuber.cube.strip(this.strips[0]);if(t=[[s,r],[r,a],[a,o],[o,s]].every(t=>{c.copy(t[0].vector).add(t[1].vector),e=9*(c.z+1)+3*(c.y+1)+(c.x+1);let s=this.cuber.cube.cubelets[e];if(s.getColor(this.faces[t[0].index])==this.faces[t[0].initial]&&s.getColor(this.faces[t[1].index])==this.faces[t[1].initial]){c.add(i.vector),e=9*(c.z+1)+3*(c.y+1)+(c.x+1);let s=this.cuber.cube.cubelets[e];if(s.getColor(this.faces[i.index])==h.D&&s.getColor(this.faces[t[0].index])==this.faces[t[0].initial]&&s.getColor(this.faces[t[1].index])==this.faces[t[1].initial])return!0}}),!t)return void this.cuber.cube.strip(this.strips[1]);if(t=this.cuber.cube.groups[h[this.faces[l.index]]].indices.every(e=>{if(this.cuber.cube.cubelets[e].getColor(this.faces[l.index])==h.U)return!0}),!t)return void this.cuber.cube.strip(this.strips[2]);if(t=[[s,r],[r,a],[a,o],[o,s]].every(t=>{if(c.copy(l.vector).add(t[0].vector),e=9*(c.z+1)+3*(c.y+1)+(c.x+1),this.cuber.cube.cubelets[e].getColor(this.faces[t[0].index])==this.faces[t[0].initial]){c.add(t[1].vector),e=9*(c.z+1)+3*(c.y+1)+(c.x+1);let i=this.cuber.cube.cubelets[e];if(i.getColor(this.faces[t[0].index])==this.faces[t[0].initial]&&i.getColor(this.faces[t[1].index])==this.faces[t[1].initial])return!0}}),!t)return void this.cuber.cube.strip(this.strips[3])}else this.cuber.cube.strip([])}get style(){return{margin:this.height/48+"px",width:this.height/32*9+"px",height:this.height/32*9+"px","min-width":"0%","min-height":"0%","text-transform":"none"}}get exps(){return this.operations[this.layers]}twist(e){this.cuber.cube.twister.twist(e)}reverse(){null!=this.cuber.cube.history.last&&this.cuber.cube.twister.twist(this.cuber.cube.history.last.value,!0,1,!1)}};S([Object(r.Inject)("cuber"),P("design:type",O)],k.prototype,"cuber",void 0),S([Object(r.Inject)("option"),P("design:type",E)],k.prototype,"option",void 0),k=S([Object(r.Component)({template:i(5)})],k);var C=k,D=function(e,t,i,s){var r,n=arguments.length,a=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},T=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let A=class extends s.default{onValueChange(e){this.$emit("input",e)}};D([Object(r.Inject)("option"),T("design:type",E)],A.prototype,"option",void 0),D([Object(r.Prop)({required:!0}),T("design:type",Boolean)],A.prototype,"value",void 0),D([Object(r.Watch)("value"),T("design:type",Function),T("design:paramtypes",[Boolean]),T("design:returntype",void 0)],A.prototype,"onValueChange",null),A=D([Object(r.Component)({template:i(6)})],A);var j=A;class B{constructor(){this.cube=new I;for(let e of this.cube.cubelets)e.mirror=!1;this.renderer=new n.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0,alpha:!0}),this.renderer.setClearColor(0,0),this.renderer.setPixelRatio(1),this.renderer.setSize(128,128,!0),this.scene=new n.Scene,this.scene.rotation.x=Math.PI/6,this.scene.rotation.y=Math.PI/16-Math.PI/4,this.scene.add(this.cube),this.camera=new n.PerspectiveCamera(50,1,1,32*F.SIZE);let e=2*Math.atan(.25)*180/Math.PI;this.camera.aspect=1,this.camera.fov=e,this.camera.position.z=3*F.SIZE*4,this.camera.lookAt(this.scene.position),this.camera.updateProjectionMatrix(),this.renderer.setSize(128,128,!0)}snap(e,t){this.cube.strip(e),this.cube.reset();let i=new b(t,!0,1).parse();for(const e of i){let t=-Math.PI/2;e.reverse&&(t=-t),e.times&&(t*=e.times);let i=this.cube.groups[e.exp];i.angle=0,i.hold(),i.angle=t,i.drop()}this.camera.aspect=1,this.camera.updateProjectionMatrix(),this.renderer.render(this.scene,this.camera);let s=this.renderer.domElement.toDataURL("image/png").split(";base64,"),r=s[0].split(":")[1],n=window.atob(s[1]),a=n.length,o=new Uint8Array(a);for(let e=0;e<a;++e)o[e]=n.charCodeAt(e);return new Blob([o],{type:r})}}var V=function(e,t,i,s){var r,n=arguments.length,a=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},Z=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let q=class extends s.default{constructor(){super(...arguments),this.capture=new B,this.blobs=[],this.algs=i(7)}onValueChange(e){this.$emit("input",e)}mounted(){this.loop()}loop(){if(requestAnimationFrame(this.loop.bind(this)),!this.value)return;let e=this.blobs.length;if(e<119){let t=0;for(;e>=this.algs[t].algs.length;)e-=this.algs[t].algs.length,t++;this.blobs.push(this.capture.snap(this.algs[t].strips,this.algs[t].algs[e].alg))}}};V([Object(r.Prop)({required:!0}),Z("design:type",Boolean)],q.prototype,"value",void 0),V([Object(r.Watch)("value"),Z("design:type",Function),Z("design:paramtypes",[Boolean]),Z("design:returntype",void 0)],q.prototype,"onValueChange",null),q=V([Object(r.Component)({template:i(8)})],q);var G=q,W=function(e,t,i,s){var r,n=arguments.length,a=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(n<3?r(a):n>3?r(t,i,a):r(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},N=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let H=class extends s.default{constructor(){super(),this.keyboard=new C,this.menu=!1,this.tune=!1,this.width=0,this.height=0,this.size=0,this.alg=!1;let e=document.createElement("canvas");this.cuber=new O(e),this.option=new E(this.cuber)}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.size=Math.min(this.width/8,this.height/14),this.cuber.width=this.width,this.cuber.height=this.height-4*this.size,this.cuber.resize();let e=this.$refs.cuber;e instanceof HTMLElement&&(e.style.width=this.width+"px",e.style.height=this.height-4*this.size+"px");let t=this.$refs.keyboard;t instanceof C&&(t.width=8*this.size-this.size/8,t.height=4*this.size)}mounted(){if(this.$refs.cuber instanceof Element){this.cuber.cube.twister.twist("*"),this.$refs.cuber.appendChild(this.cuber.canvas),this.$nextTick(this.resize)}this.loop()}loop(){requestAnimationFrame(this.loop.bind(this)),this.cuber.render()}};W([Object(r.Provide)("cuber"),N("design:type",O)],H.prototype,"cuber",void 0),W([Object(r.Provide)("option"),N("design:type",E)],H.prototype,"option",void 0),H=W([Object(r.Component)({template:i(9),components:{keyboard:C,tune:j,alg:G}}),N("design:paramtypes",[])],H);var X=H,$=(i(10),i(11),i(12),i(4)),Y=i.n($);s.default.use(Y.a);const J=new Y.a({});new s.default({vuetify:J,el:"#app",render:e=>e(X)})}]);